{
  "hash": "d1e46c2a5e8a6a5682ee2cd7b3554ce2",
  "result": {
    "markdown": "---\ntitle: Regresión\nkeep-md: true\nlang: es\n---\n\n\n\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n``` r\nlibrary(tidyverse) \n# Incluye los siguientes paquetes:\n# - readr: para la lectura de ficheros csv. \n# - dplyr: para el preprocesamiento y manipulación de datos.\nlibrary(vtable) # para resúmenes estadísticos.\nlibrary(skimr) # para resúmenes estadísticos.\nlibrary(summarytools) # para resúmenes estadísticos.\nlibrary(knitr) # para el formateo de tablas.\nlibrary(kableExtra) # para personalizar el formato de las tablas.\n```\n\nTambién se necesita conocer las ecuaciones de los principales modelos de regresión, que se resumen en la siguiente tabla.\n\n| Modelo                  |      Ecuación general      |\n|:------------------------|:--------------------------:|\n| Lineal                  |          $y=a+bx$          |\n| Parabólico              |       $y=a+bx+cx^2$        |\n| Polinómico de grado $n$ | $y=a_0+a_1x+\\cdots+a_nx^n$ |\n| Potencial               |          $y=ax^b$          |\n| Exponencial             |        $y=e^{a+bx}$        |\n| Logarítmico             |       $y=a+b\\log x$        |\n| Inverso                 |         $y=a+b/x$          |\n| Curva S o Sigmoidal     |       $y= e^{a+b/x}$       |\n\n\n::: {#exr-regresion-1}\nSe han medido dos variables $X$ e $Y$ en 10 individuos obteniendo los siguientes resultados:\n\n$$\n\\begin{array}{lrrrrrrrrrr}\n\\hline\nX & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\\\\nY & 2 & 5 & 8 & 11 & 14 & 17 & 20 & 23 & 26 & 29\\\\\n\\hline\n\\end{array}\n$$\n\n\na.  Crear un conjunto de datos con las variables `x` e `y`.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-1_6ef216e957b9c9ba76a97c60aef905a6'}\n    \n    ```{.r .cell-code}\n    df <- data.frame(\n        x = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9),\n        y = c(2, 5, 8, 11, 14, 17, 20, 23, 26, 29)\n    )\n    ```\n    :::\n\n    :::\n\na.  Dibujar el diagrama de dispersión correspondiente. ¿Qué tipo de modelo de regresión se ajusta mejor a la nube de puntos?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución 1\n\n    Para dibujar un diagrama de dispersión se puede usar la función [`plot`](https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/plot) del paquete `graphics`.\n    \n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-2_60bb8c2e90e7806b73a338b19eca5e89'}\n    \n    ```{.r .cell-code}\n    plot(df$x, df$y, xlab = \"X\", ylab = \"Y\", main = \"Diagrama de dispersión\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-2-1.png){width=672}\n    :::\n    :::\n\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución 2\n\n    Otra alternativa es usar la función la función [`geom_point`](https://aprendeconalf.es/manual-r/07-graficos.html#diagramas-de-puntos) del paquete `ggplot2`.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-3_a267c464d4afee84a46f7bf7f0a81c20'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = x, y = y)) +\n        geom_point(col = \"red\") +\n        labs(title = \"Diagrama de dispersión\", x = \"X\", y = \"Y\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-3-1.png){width=672}\n    :::\n    :::\n\n\n    El tipo de modelo que mejor se ajusta es lineal, ya que todos los puntos están alineados.\n    :::\n\na.  Calcular la recta de regresión de $Y$ sobre $X$.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Para ajustar un modelo de regresión se utiliza la función [`lm`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/lm) del paquete `stats`. Esta función requiere que se le pase como parámetro la fórmula del modelo de regresión que debe tener la sintaxis `y ~ f(x)`, donde `y` es la variable dependiente en el modelo, `x` es la variable independiente, y `f(x)` es una expresión matemática que describe el modelo.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-4_3a0f4e4a58cdeeed627f9b3fa730df7e'}\n    \n    ```{.r .cell-code}\n    recta_y_x <- lm(y ~ x, df) \n    summary(recta_y_x)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning in summary.lm(recta_y_x): essentially perfect fit: summary may be\n    unreliable\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = y ~ x, data = df)\n    \n    Residuals:\n           Min         1Q     Median         3Q        Max \n    -3.675e-15 -8.783e-16  5.168e-16  9.646e-16  1.944e-15 \n    \n    Coefficients:\n                 Estimate Std. Error   t value Pr(>|t|)    \n    (Intercept) 2.000e+00  1.049e-15 1.906e+15   <2e-16 ***\n    x           3.000e+00  1.965e-16 1.527e+16   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 1.785e-15 on 8 degrees of freedom\n    Multiple R-squared:      1,\tAdjusted R-squared:      1 \n    F-statistic: 2.33e+32 on 1 and 8 DF,  p-value: < 2.2e-16\n    ```\n    :::\n    :::\n\n\n    La recta de regresión de $Y$ sobre $X$ es $y = 2 + 3 x$.\n    :::\n\na.  Obtener el coeficiente de regresión de la recta anterior e interpretarlo.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n    El coeficiente de regresión es la pendiente de la recta de regresión\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-5_6b5ed59f5600c3f6562b11598431364e'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de regresión de Y sobre X:\", recta_y_x$coefficients[[\"x\"]]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de regresión de Y sobre X: 3\n    ```\n    :::\n    :::\n\n\n    El coeficiente de regresión de $Y$ sobre $X$ vale 3, lo que indica que $Y$ aumenta 3 unidades por cada unidad que aumenta $X$.\n    :::\n\na.  Dibujar la recta de regresión de $Y$ sobre $X$ sobre el diagrama de dispersión. ¿Cómo son los residuos del modelo de regresión?\n\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución 1\n\n    Para dibujar la recta de regresión se puede usar la función [`abline`](https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/abline) del paquete `graphics`.\n    \n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-6_4510a8bb7dc261b82f8c7e8621262ad0'}\n    \n    ```{.r .cell-code}\n    plot(df$x, df$y, xlab = \"X\", ylab = \"Y\", main = \"Diagrama de dispersión\")\n    abline(recta_y_x)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-6-1.png){width=672}\n    :::\n    :::\n\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución 2\n\n    Otra alternativa es usar la geometría de ajuste de regresión por mínimos cuadrados [`geom_smooth`](https://aprendeconalf.es/manual-r/07-graficos.html#interpolaci%C3%B3n-y-ajustes-de-regresi%C3%B3n) del paquete `ggplot2`.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-7_38af4206843d55169c3acd607b14e396'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = x, y = y)) +\n        geom_point(col = \"red\") +\n        geom_smooth(method = \"lm\") +\n        labs(title = \"Diagrama de dispersión\", x = \"X\", y = \"Y\")\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    `geom_smooth()` using formula = 'y ~ x'\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-7-1.png){width=672}\n    :::\n    :::\n\n\n    Como la recta pasa por todos los puntos del diagrama de dispersión, los residuos son nulos.\n    :::\n\na.  Calcular el coeficiente de determinación del modelo lineal e interpretarlo.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-8_620f695321a60a62791604d467e61b1a'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de determinación lineal R²:\", summary(recta_y_x)$r.squared))\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning in summary.lm(recta_y_x): essentially perfect fit: summary may be\n    unreliable\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de determinación lineal R²: 1\n    ```\n    :::\n    :::\n\n\n    Como el coeficiente de determinación lineal vale 1, el ajuste de la recta de regresión es perfecto.\n    :::\n\na.  Calcular la recta de regresión de $X$ sobre $Y$. ¿Coincide con la recta de regresión de $Y$ sobre $X$?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-9_c87776714b4ce3f68255a9e655237cf0'}\n    \n    ```{.r .cell-code}\n    recta_x_y <- lm(x ~ y, df) \n    summary(recta_x_y)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning in summary.lm(recta_x_y): essentially perfect fit: summary may be\n    unreliable\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = x ~ y, data = df)\n    \n    Residuals:\n           Min         1Q     Median         3Q        Max \n    -1.435e-15 -5.090e-16 -2.062e-17  3.798e-16  1.943e-15 \n    \n    Coefficients:\n                  Estimate Std. Error    t value Pr(>|t|)    \n    (Intercept) -6.667e-01  6.179e-16 -1.079e+15   <2e-16 ***\n    y            3.333e-01  3.484e-17  9.567e+15   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 9.494e-16 on 8 degrees of freedom\n    Multiple R-squared:      1,\tAdjusted R-squared:      1 \n    F-statistic: 9.153e+31 on 1 and 8 DF,  p-value: < 2.2e-16\n    ```\n    :::\n    :::\n\n\n    La recta de regresión de $X$ sobre $Y$ es $x = -0.6666667 + 0.3333333 x$, que es la misma que la recta de $Y$ sobre $X$, ya que el ajuste es perfecto, y tanto los residuos en $Y$ como los residuos en $X$ valen cero para esta recta.\n    :::\n:::\n\n:::{#exr-regresion-2}\nEl fichero [`horas-estudio.csv`](datos/horas-estudio.csv) contiene información sobre las horas de estudio diarias de una muestra de alumnos de ingeniería, y el número de asignaturas suspendidas al final del curso.\n\na.  Crear un data frame con los datos de las horas de estudio y los suspensos a partir del fichero [`horas-estudio.csv`](datos/horas-estudio.csv).\n\n    :::{.callout-tip collapse=\"true\"} \n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-10_7b99793c9cd652252f876c5521b3f3b8'}\n    \n    ```{.r .cell-code}\n    library(readr)\n    df <- read_csv(\"datos/horas-estudio.csv\")\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Rows: 30 Columns: 2\n    ── Column specification ────────────────────────────────────────────────────────\n    Delimiter: \",\"\n    dbl (2): Horas, Suspensos\n    \n    ℹ Use `spec()` to retrieve the full column specification for this data.\n    ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    df\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 30 × 2\n       Horas Suspensos\n       <dbl>     <dbl>\n     1   3.5         1\n     2   0.6         5\n     3   2.8         1\n     4   2.5         3\n     5   2.6         1\n     6   3.9         0\n     7   1.5         3\n     8   0.7         3\n     9   3.6         1\n    10   3.7         1\n    # ℹ 20 more rows\n    ```\n    :::\n    :::\n\n    :::\n\na.  Dibujar el diagrama de dispersión correspondiente. ¿Qué tipo de modelo de regresión se ajusta mejor a la nube de puntos?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-11_9640840bc1693d8ab6f4a24a2e9ac8c4'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = Horas, y = Suspensos)) +\n        geom_point(col = \"red\") +\n        labs(title = \"Diagrama de dispersión\", x = \"Horas de estudio\", y = \"Asignaturas suspensas\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-11-1.png){width=672}\n    :::\n    :::\n\n\n    El tipo de modelo que mejor se ajusta es lineal, ya que hay una tendencia lineal en la nube de puntos y además es inversa.\n    :::\n\na.  Calcular la recta de regresión de los suspensos sobre las horas de estudio.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-12_455cdb7a0b86c85ce7ab1523a9b97f7e'}\n    \n    ```{.r .cell-code}\n    recta_suspensos_horas <- lm(Suspensos ~ Horas, df) \n    summary(recta_suspensos_horas)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = Suspensos ~ Horas, data = df)\n    \n    Residuals:\n         Min       1Q   Median       3Q      Max \n    -1.03614 -0.53214 -0.02013  0.49187  1.22587 \n    \n    Coefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n    (Intercept)   4.8491     0.2622   18.49  < 2e-16 ***\n    Horas        -1.2300     0.1106  -11.12  8.7e-12 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 0.6359 on 28 degrees of freedom\n    Multiple R-squared:  0.8155,\tAdjusted R-squared:  0.8089 \n    F-statistic: 123.8 on 1 and 28 DF,  p-value: 8.7e-12\n    ```\n    :::\n    :::\n\n\n    La recta de regresión de los suspensos sobre las horas es $\\textsf{suspensos}= 4.8491273 + -1.2299972 \\textsf{horas}$.\n    :::\n\na.  Obtener el coeficiente de regresión de la recta anterior e interpretarlo.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-13_b90d677a9829e84faa1056d9d53fdf2e'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de regresión de Suspensos sobre Horas:\", recta_suspensos_horas$coefficients[[\"Horas\"]]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de regresión de Suspensos sobre Horas: -1.22999717844331\n    ```\n    :::\n    :::\n\n\n    El coeficiente de regresión de los suspensos sobre las horas de estudio vale  -1.2299972, lo que indica que por cada hora de estudio se obtendrán 1.2299972 suspensos menos al final del curso.\n    :::\n\na.  Dibujar la recta de regresión  sobre el diagrama de dispersión. ¿El ajuste es mejor o peor que el del ejercicio anterior?\n\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-14_8d3b1f01a96ea4e12d0cdff3bb27c0c9'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = Horas, y = Suspensos)) +\n        geom_point(col = \"red\") +\n        geom_smooth(method = \"lm\") +\n        labs(title = \"Diagrama de dispersión\", x = \"Horas de estudio\", y = \"Asignaturas suspensas\")\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    `geom_smooth()` using formula = 'y ~ x'\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-14-1.png){width=672}\n    :::\n    :::\n\n\n    En este caso el ajuste no es perfecto, ya que es imposible que la recta pase por todos los puntos como ocurría en el ejercicio anterior. Por tanto, el ajuste es peor.\n    :::\n\na.  Calcular el coeficiente de determinación del modelo lineal e interpretarlo.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-15_d1b9c8d37ccfe6e24f8c9f4776b6a412'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de determinación lineal R²:\", summary(recta_suspensos_horas)$r.squared))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de determinación lineal R²: 0.81549948723949\n    ```\n    :::\n    :::\n\n\n    Como el coeficiente de determinación lineal vale 0.8154995 que está bastante próximo a 1, el ajuste es bueno, y el modelo puede utilizarse con fines predictivos.\n    :::\n\na.  Utilizar la recta de regresión para predecir el número de suspensos correspondiente a 3 horas de estudio diarias. ¿Es fiable esta predicción? \n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-16_83db87809617aedd45136bfd8fc3e5f5'}\n    \n    ```{.r .cell-code}\n    predict.lm(recta_suspensos_horas, newdata = list(Horas = 3))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n           1 \n    1.159136 \n    ```\n    :::\n    :::\n\n\n    La predicción será fiable ya que el coeficiente de determinación está próximo a 1 y el tamaño de la muestra no es muy pequeño.\n    :::\n\na.  Según el modelo lineal, ¿cuántas horas diarias tendrá que estudiar como mínimo un alumno si quiere aprobarlo todo?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como ahora queremos predecir el número de horas de estudio, necesitamos calcular la recta de regresión de la horas sobre los suspensos.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-17_6479f5944eca4d30ec6f797a8fdfed42'}\n    \n    ```{.r .cell-code}\n    recta_horas_suspensos <- lm(Horas ~ Suspensos, df) \n    predict.lm(recta_horas_suspensos, newdata = list(Suspensos = 0))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n           1 \n    3.607387 \n    ```\n    :::\n    :::\n\n    :::\n:::\n\n:::{#exr-regresion-3}\nDespués de tomar un litro de vino se ha medido la concentración de alcohol en la sangre en distintos instantes, obteniendo los siguientes datos\n\n$$\n\\begin{array}{lrrrrrrr}\n\\hline \n\\mbox{Tiempo después (minutos)} & 30 & 60 & 90 & 120 & 150 & 180 & 210\\\\ \n\\mbox{Alcohol (gramos/litro)} & 1.6 & 1.7 & 1.5 & 1.1 & 0.7 & 0.2 & 2.1\\\\\n\\hline\n\\end{array}\n$$\n\na.  Crear un data frame con los datos del tiempo y la concentración de alcohol.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-18_842fdd19f358269bf9aac1c822f592d3'}\n    \n    ```{.r .cell-code}\n    df <- data.frame(\n        Tiempo = c(30, 60, 90, 120, 150, 180, 210),\n        Alcohol = c(1.6, 1.7, 1.5, 1.1, 0.7, 0.2, 2.1)\n    )\n    df\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n      Tiempo Alcohol\n    1     30     1.6\n    2     60     1.7\n    3     90     1.5\n    4    120     1.1\n    5    150     0.7\n    6    180     0.2\n    7    210     2.1\n    ```\n    :::\n    :::\n\n    :::\n\na.  Calcular el coeficiente de correlación lineal. ¿Existe relación lineal entre la concentración de alcohol y el tiempo que pasa?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Para calcular el coeficiente de correlación lineal de Pearson se puede utilar la función [`cor`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor) del paquete `stats`.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-19_7e1b84ad292c89627a16d128e3211a41'}\n    \n    ```{.r .cell-code}\n    cor(df$Tiempo, df$Alcohol)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] -0.2730367\n    ```\n    :::\n    :::\n\n\n    El valore del coeficiente de correlación lineal es muy bajo, por lo que aparentemente no hay relación lineal entre la concentración de alcohol en sangre y el tiempo que pasa.\n    :::\n\na.  Dibujar el diagrama de dispersión correspondiente y la recta de regresión de la concentración de alcohol sobre el tiempo. ¿Por qué el ajuste es tan malo?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-20_4230874691faa756eb9e83563903e208'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = Tiempo, y = Alcohol)) +\n        geom_point(col = \"red\") +\n        geom_smooth(method = \"lm\") +\n        labs(title = \"Diagrama de dispersión\", x = \"Tiempo en minutos\", y = \"Concentración de alcohol en sangre (g/l)\")\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    `geom_smooth()` using formula = 'y ~ x'\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-20-1.png){width=672}\n    :::\n    :::\n\n\n    El ajuste es malo porque hay un dato atípico que no sigue la misma tendencia que el resto. \n    :::\n\na.  Eliminar el dato atípico y calcular la recta de la concentración de alcohol sobre el tiempo. ¿Ha mejorado el modelo?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-21_65fdce270b0aa9a81090f15eb0a64bb9'}\n    \n    ```{.r .cell-code}\n    # Eliminamos el dato atípico que está en la fila \n    df <- df[-c(7), ]\n    recta_alcohol_tiempo <- lm(Alcohol ~ Tiempo, df) \n    summary(recta_alcohol_tiempo)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = Alcohol ~ Tiempo, data = df)\n    \n    Residuals:\n           1        2        3        4        5        6 \n    -0.27619  0.12095  0.21810  0.11524  0.01238 -0.19048 \n    \n    Coefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n    (Intercept)  2.173333   0.201927  10.763 0.000423 ***\n    Tiempo      -0.009905   0.001728  -5.731 0.004591 ** \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 0.2169 on 4 degrees of freedom\n    Multiple R-squared:  0.8914,\tAdjusted R-squared:  0.8643 \n    F-statistic: 32.84 on 1 and 4 DF,  p-value: 0.004591\n    ```\n    :::\n    :::\n\n\n    La recta de regresión de la concentración de alcohol en sangre sobre el tiempo es $\\textsf{alcohol}= 2.1733333 + -0.0099048 \\textsf{tiempo}$.\n\n    El modelo ha mejorado notablemente ya que ahora el coeficiente de determinación lineal $R^2=0.8914286$, que está muy próximo a 1.\n    :::\n\na.  Según el modelo de regresión lineal, ¿a qué velocidad metaboliza esta persona el alcohol?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-22_567d48101caf488757655f14cf0b15df'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de regresión de la concentración de alchol sobre el tiempo:\", recta_alcohol_tiempo$coefficients[[\"Tiempo\"]]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de regresión de la concentración de alchol sobre el tiempo: -0.00990476190476191\n    ```\n    :::\n    :::\n\n\n    Así pues, la velocidad de metabolización del alcohol es 0.0099048 g/l$\\cdot$min.\n    :::\n\na.  Si la concentración máxima de alcohol en la sangre que permite la ley para poder conducir es $0.3$ g/l, ¿cuánto tiempo habrá que esperar después de tomarse un litro de vino para poder conducir sin infringir la ley? ¿Es fiable esta predicción?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como ahora queremos predecir el tiempo, necesitamos calcular la recta de regresión del tiempo sobre la concentración de alcohol.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-23_46bca3be9afceda0d2cebc73267d2e08'}\n    \n    ```{.r .cell-code}\n    recta_tiempo_alcohol <- lm(Tiempo ~ Alcohol, df) \n    predict.lm(recta_tiempo_alcohol, newdata = list(Alcohol = 0.3))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n      1 \n    180 \n    ```\n    :::\n    :::\n\n\n    Aunque el coeficiente de determinación lineal está próximo a 1, el tamaño muestral es demasiado pequeño para que la predicción sea fiable.\n    :::\n:::\n\n:::{#exr-regresion-4}\nEl fichero [`pib-usa.csv`](datos/pib-usa.csv) contiene información sobre el producto interior bruto de Estados Unidos en billones de dólares americanos desde 1947 hasta 2022.\n\na.  Crear un data frame con los datos del PIB y los años a partir del fichero [`pib-usa.csv`](datos/horas-estudio.csv).\n\n    :::{.callout-tip collapse=\"true\"} \n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-24_93945578b9a886c4396f66dab3801168'}\n    \n    ```{.r .cell-code}\n    library(readr)\n    df <- read_csv(\"datos/pib-usa.csv\")\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Rows: 76 Columns: 2\n    ── Column specification ────────────────────────────────────────────────────────\n    Delimiter: \",\"\n    dbl (2): Año, PIB\n    \n    ℹ Use `spec()` to retrieve the full column specification for this data.\n    ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    df\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 76 × 2\n         Año   PIB\n       <dbl> <dbl>\n     1  1947  244.\n     2  1948  267.\n     3  1949  276.\n     4  1950  282.\n     5  1951  338.\n     6  1952  362.\n     7  1953  390.\n     8  1954  387.\n     9  1955  415.\n    10  1956  443.\n    # ℹ 66 more rows\n    ```\n    :::\n    :::\n\n    :::\n\na.  Dibujar el diagrama de dispersión que represente la evolución anual del PIB. ¿Qué tipo de modelo de regresión se ajusta mejor a la nube de puntos?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-25_d69a8725b7bce7d68c08a0dd97542f32'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = Año, y = PIB)) +\n        geom_point(col = \"red\") +\n        labs(title = \"Evolución del PIB de Estados Unidos\", x = \"Año\", y = \"PIB en billones dólares\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-25-1.png){width=672}\n    :::\n    :::\n\n\n    A la vista de la forma de la nube de puntos parece que la evolución del PIB es exponencial.\n    :::\n\na.  Dibujar el diagrama de dispersión del logaritmo del PIB y los años.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-26_4160380ed8b967f23f19f6c09255328c'}\n    \n    ```{.r .cell-code}\n    library(dplyr)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    \n    Attaching package: 'dplyr'\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    The following objects are masked from 'package:stats':\n    \n        filter, lag\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    The following objects are masked from 'package:base':\n    \n        intersect, setdiff, setequal, union\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    df <- mutate(df, logPIB = log(PIB)) \n    ggplot(df, aes(x = Año, y = logPIB)) +\n            geom_point(col = \"red\") +\n            labs(title = \"Evolución del PIB de Estados Unidos\", x = \"Año\", y = \"Logaritmo del PIB en billones dólares\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-26-1.png){width=672}\n    :::\n    :::\n\n\n    La nube de puntos tienen una clara forma lineal, lo que confirma que la evolución del PIB es exponencial.\n    :::\n\na.  Calcular el modelo de regresión exponencial del PIB sobre los años.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-27_807ee49b656be8a7363ded9ff86dd027'}\n    \n    ```{.r .cell-code}\n    recta_logPIB_años <- lm(log(PIB) ~ Año, df) \n    summary(recta_logPIB_años)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = log(PIB) ~ Año, data = df)\n    \n    Residuals:\n         Min       1Q   Median       3Q      Max \n    -0.39115 -0.13495 -0.03532  0.17693  0.29436 \n    \n    Coefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n    (Intercept) -1.215e+02  1.951e+00  -62.27   <2e-16 ***\n    Año          6.527e-02  9.832e-04   66.39   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 0.188 on 74 degrees of freedom\n    Multiple R-squared:  0.9835,\tAdjusted R-squared:  0.9833 \n    F-statistic:  4407 on 1 and 74 DF,  p-value: < 2.2e-16\n    ```\n    :::\n    :::\n\n\n    El modelo de regresión exponencial que mejor explica la evolución del PIB es $\\textsf{PIB}= e^{-121.4998223 + 0.065271 \\textsf{Año}}$.\n    :::\n\na.  ¿Cuál es la tasa de crecimiento porcentual anual del PIB?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-28_37b5ef0d629d494181bf6318026f3e30'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de regresión del logaritmo del PIB sobre los años:\", recta_logPIB_años$coefficients[[\"Año\"]]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de regresión del logaritmo del PIB sobre los años: 0.0652710244896027\n    ```\n    :::\n    :::\n\n\n    El coeficiente de regresión de los suspensos sobre las horas de estudio vale  0.065271, lo que indica que la tasa de crecimiento anual del PIB es 6.5271024%.\n    :::\n\na.  Dibujar el modelo de regresión exponencial sobre el diagrama de dispersión.\n\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-29_c20880e825e3e7be1627252c52537b81'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = Año, y = PIB)) +\n            geom_point(col = \"red\") +\n            geom_smooth(method=\"glm\", method.args=list(family=gaussian(link=\"log\")))\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    `geom_smooth()` using formula = 'y ~ x'\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-29-1.png){width=672}\n    :::\n    \n    ```{.r .cell-code}\n            labs(title = \"Evolución del PIB de Estados Unidos\", x = \"Año\", y = \"Logaritmo del PIB en billones dólares\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    $x\n    [1] \"Año\"\n    \n    $y\n    [1] \"Logaritmo del PIB en billones dólares\"\n    \n    $title\n    [1] \"Evolución del PIB de Estados Unidos\"\n    \n    attr(,\"class\")\n    [1] \"labels\"\n    ```\n    :::\n    :::\n\n\n    En este caso el ajuste no es perfecto, ya que es imposible que la recta pase por todos los puntos como ocurría en el ejercicio anterior. Por tanto, el ajuste es peor.\n    :::\n\n\na.  ¿Es el modelo de regresión exponencial un buen modelo para explicar la evolución del PIB?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-30_488687e571755710ff67a81a7d97c807'}\n    \n    ```{.r .cell-code}\n    cat(paste(\"Coeficiente de determinación exponencial R²:\", summary(recta_logPIB_años)$r.squared))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Coeficiente de determinación exponencial R²: 0.983487569858149\n    ```\n    :::\n    :::\n\n\n    Como el coeficiente de determinación lineal vale 0.9834876 que está bastante próximo a 1, el ajuste es bueno, y el modelo exponencial explica muy bien la evolución del PIB.\n    :::\n\na.  Utilizar el modelo de regresión exponencial para predecir el PIB del año 2024. ¿Es fiable esta predicción? \n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-31_88d704e9eeafe6014ac691bcb9b0dc7f'}\n    \n    ```{.r .cell-code}\n    exp(predict.lm(recta_logPIB_años, newdata = list(Año = 2024)))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n          1 \n    40486.8 \n    ```\n    :::\n    :::\n\n\n    La predicción será fiable ya que el coeficiente de determinación está próximo a 1, el tamaño de la muestra no es muy pequeño y el año para el que se realiza la predicción no está lejos del rango de años de la muestra.\n    :::\n\na.  ¿Cuándo se alcanzará un PIB de 50000 billones de dólares?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como ahora queremos predecir el año en el que se alcanzará el PIB dado, necesitamos construir el modelo de regresión de los años sobre el PIB. Como la relación entre el PIB y los años es exponencial, la relación entre los años y el PIB será la inversa, es decir, el modelo logarítmico.\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-32_b0589dc440b0a9efce0552fdcfea0cc9'}\n    \n    ```{.r .cell-code}\n    log_años_PIB <- lm(Año ~ log(PIB), df) \n    summary(log_años_PIB)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = Año ~ log(PIB), data = df)\n    \n    Residuals:\n        Min      1Q  Median      3Q     Max \n    -4.4049 -2.5367  0.2662  1.7718  6.4965 \n    \n    Coefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n    (Intercept) 1863.498      1.852 1006.29   <2e-16 ***\n    log(PIB)      15.068      0.227   66.39   <2e-16 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 2.857 on 74 degrees of freedom\n    Multiple R-squared:  0.9835,\tAdjusted R-squared:  0.9833 \n    F-statistic:  4407 on 1 and 74 DF,  p-value: < 2.2e-16\n    ```\n    :::\n    :::\n\n\n    El modelo de regresión logarítmico de los años sobre el PIB es $\\textsf{Año}= 1863.4980331 + 15.0677514 \\log(\\textsf{PIB})$.\n    :::\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-33_35c2b5a9ea36ebc95b86444735939906'}\n    \n    ```{.r .cell-code}\n    predict.lm(log_años_PIB, newdata = list(PIB = 50000))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n           1 \n    2026.528 \n    ```\n    :::\n    :::\n\n:::\n\n\n:::{#exr-regresion-5}\nEl fichero [`dieta.csv`](datos/dieta.csv) contiene información sobre el los kilos perdidos con una dieta de adelgazamiento.\n\na.  Crear un data frame con los datos de la dieta a partir del fichero [`dieta.csv`](datos/dieta.csv).\n\n    :::{.callout-tip collapse=\"true\"} \n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-34_f1a991553120d2c9c763529c6df21cb6'}\n    \n    ```{.r .cell-code}\n    library(readr)\n    df <- read_csv(\"datos/dieta.csv\")\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Rows: 40 Columns: 3\n    ── Column specification ────────────────────────────────────────────────────────\n    Delimiter: \",\"\n    chr (1): ejercicio\n    dbl (2): dias, peso.perdido\n    \n    ℹ Use `spec()` to retrieve the full column specification for this data.\n    ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    df\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 40 × 3\n        dias peso.perdido ejercicio\n       <dbl>        <dbl> <chr>    \n     1    14         2.95 no       \n     2    18         5.65 no       \n     3    22         6.56 no       \n     4    26         3.56 no       \n     5    30         6.17 no       \n     6    34         9.4  no       \n     7    38        12.4  no       \n     8    42        12.9  no       \n     9    46        13.9  no       \n    10    50        10.8  no       \n    # ℹ 30 more rows\n    ```\n    :::\n    :::\n\n    :::\n\na.  Dibujar el diagrama de dispersión de los kilos perdidos en función del número de días con la dieta. ¿Qué tipo de modelo de regresión se ajusta mejor a la nube de puntos?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-35_96ff5d0898aa080b95b0e582facae629'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = dias, y = peso.perdido)) +\n        geom_point(col = \"red\") +\n        labs(title = \"Diagrama de dispersión del peso perdido y los días de dieta\", x = \"Días de dieta\", y = \"Peso perdido en Kg\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-35-1.png){width=672}\n    :::\n    :::\n\n\n    La nube de puntos es bastante difusa aunque parece apreciarse una tendencia logarítmica o sigmoidal.\n    :::\n\na.  Calcular el modelo de regresión sigmoidal del peso perdido sobre los días de dieta. ¿Es un buen modelo para explicar la relación entre el peso perdido y los días de dieta?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-36_204e23ad5768519426da8e9653f3e805'}\n    \n    ```{.r .cell-code}\n    sigmoidal_peso_dias <- lm(log(peso.perdido) ~ I(1/dias), df) \n    summary(sigmoidal_peso_dias)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = log(peso.perdido) ~ I(1/dias), data = df)\n    \n    Residuals:\n         Min       1Q   Median       3Q      Max \n    -0.83810 -0.17537  0.06906  0.17786  0.71841 \n    \n    Coefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n    (Intercept)   3.09446    0.08819  35.088  < 2e-16 ***\n    I(1/dias)   -25.65167    2.94543  -8.709 1.37e-10 ***\n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 0.2952 on 38 degrees of freedom\n    Multiple R-squared:  0.6662,\tAdjusted R-squared:  0.6574 \n    F-statistic: 75.85 on 1 and 38 DF,  p-value: 1.374e-10\n    ```\n    :::\n    :::\n\n\n    El modelo de regresión sigmoidal que mejor explica el peso perdido en función de los días de dieta es $\\textsf{Peso}= e^{3.0944614 -25.6516729 / \\textsf{dias}}$.\n    :::\n\na.  Dibujar el diagrama de dispersión de los kilos perdidos en función del número de días con la dieta según si la persona hace ejercicio o no. ¿Qué conclusiones se pueden sacar?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-37_51fcd669e5a64ca7f5aa7eef944669c6'}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = dias, y = peso.perdido, color = ejercicio)) +\n        geom_point() +\n        labs(title = \"Diagrama de dispersión del peso perdido y los días de dieta\", x = \"Días de dieta\", y = \"Peso perdido en Kg\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](05-regresion_files/figure-html/unnamed-chunk-37-1.png){width=672}\n    :::\n    :::\n\n\n    Claramente la nube de puntos de las personas que hacen ejercicio está por encima de la de los que no hacen ejercicio, lo que indica que hacer ejercicio favorece la pérdida de peso. Los más razonable es construir modelos de regresión para cada grupo.\n    :::\n\na.  Construir el modelo de regresión inverso del peso perdido sobre los días de dieta para los que hacen ejercicio y para los que no.\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-38_c35bbfe7bff4bcb2c0f445f0bad2f25f'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(kableExtra)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    \n    Attaching package: 'kableExtra'\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    The following object is masked from 'package:dplyr':\n    \n        group_rows\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    df %>%\n        nest_by(ejercicio) %>%\n        mutate(mod = list(lm(peso.perdido ~ I(1/dias), data = data))) %>%\n        summarize(tidy(mod)) %>%\n        kable() %>%\n        kable_styling()\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in\n    dplyr 1.1.0.\n    ℹ Please use `reframe()` instead.\n    ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`\n      always returns an ungrouped data frame and adjust accordingly.\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    `summarise()` has grouped output by 'ejercicio'. You can override using the\n    `.groups` argument.\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> ejercicio </th>\n       <th style=\"text-align:left;\"> term </th>\n       <th style=\"text-align:right;\"> estimate </th>\n       <th style=\"text-align:right;\"> std.error </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;\"> no </td>\n       <td style=\"text-align:left;\"> (Intercept) </td>\n       <td style=\"text-align:right;\"> 14.92508 </td>\n       <td style=\"text-align:right;\"> 0.8826746 </td>\n       <td style=\"text-align:right;\"> 16.908927 </td>\n       <td style=\"text-align:right;\"> 0.0e+00 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> no </td>\n       <td style=\"text-align:left;\"> I(1/dias) </td>\n       <td style=\"text-align:right;\"> -182.19025 </td>\n       <td style=\"text-align:right;\"> 29.4795388 </td>\n       <td style=\"text-align:right;\"> -6.180227 </td>\n       <td style=\"text-align:right;\"> 7.8e-06 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> si </td>\n       <td style=\"text-align:left;\"> (Intercept) </td>\n       <td style=\"text-align:right;\"> 21.56554 </td>\n       <td style=\"text-align:right;\"> 0.7652517 </td>\n       <td style=\"text-align:right;\"> 28.180978 </td>\n       <td style=\"text-align:right;\"> 0.0e+00 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> si </td>\n       <td style=\"text-align:left;\"> I(1/dias) </td>\n       <td style=\"text-align:right;\"> -255.22492 </td>\n       <td style=\"text-align:right;\"> 25.5578527 </td>\n       <td style=\"text-align:right;\"> -9.986164 </td>\n       <td style=\"text-align:right;\"> 0.0e+00 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    :::\n\na.  ¿Han mejorado los modelos con respecto al hacer la regresión por grupos?\n\n    ::: {.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='05-regresion_cache/html/unnamed-chunk-39_64711def861109de49a4e80598e48ee2'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(kableExtra)\n    df %>%\n        nest_by(ejercicio) %>%\n        mutate(mod = list(lm(peso.perdido ~ I(1/dias), data = data))) %>%\n        summarize(glance(mod)) %>%\n        kable() %>%\n        kable_styling()\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    `summarise()` has grouped output by 'ejercicio'. You can override using the\n    `.groups` argument.\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> ejercicio </th>\n       <th style=\"text-align:right;\"> r.squared </th>\n       <th style=\"text-align:right;\"> adj.r.squared </th>\n       <th style=\"text-align:right;\"> sigma </th>\n       <th style=\"text-align:right;\"> statistic </th>\n       <th style=\"text-align:right;\"> p.value </th>\n       <th style=\"text-align:right;\"> df </th>\n       <th style=\"text-align:right;\"> logLik </th>\n       <th style=\"text-align:right;\"> AIC </th>\n       <th style=\"text-align:right;\"> BIC </th>\n       <th style=\"text-align:right;\"> deviance </th>\n       <th style=\"text-align:right;\"> df.residual </th>\n       <th style=\"text-align:right;\"> nobs </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;\"> no </td>\n       <td style=\"text-align:right;\"> 0.6796880 </td>\n       <td style=\"text-align:right;\"> 0.6618929 </td>\n       <td style=\"text-align:right;\"> 2.089080 </td>\n       <td style=\"text-align:right;\"> 38.19521 </td>\n       <td style=\"text-align:right;\"> 7.8e-06 </td>\n       <td style=\"text-align:right;\"> 1 </td>\n       <td style=\"text-align:right;\"> -42.05964 </td>\n       <td style=\"text-align:right;\"> 90.11928 </td>\n       <td style=\"text-align:right;\"> 93.10648 </td>\n       <td style=\"text-align:right;\"> 78.55660 </td>\n       <td style=\"text-align:right;\"> 18 </td>\n       <td style=\"text-align:right;\"> 20 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> si </td>\n       <td style=\"text-align:right;\"> 0.8470993 </td>\n       <td style=\"text-align:right;\"> 0.8386048 </td>\n       <td style=\"text-align:right;\"> 1.811168 </td>\n       <td style=\"text-align:right;\"> 99.72348 </td>\n       <td style=\"text-align:right;\"> 0.0e+00 </td>\n       <td style=\"text-align:right;\"> 1 </td>\n       <td style=\"text-align:right;\"> -39.20461 </td>\n       <td style=\"text-align:right;\"> 84.40921 </td>\n       <td style=\"text-align:right;\"> 87.39641 </td>\n       <td style=\"text-align:right;\"> 59.04594 </td>\n       <td style=\"text-align:right;\"> 18 </td>\n       <td style=\"text-align:right;\"> 20 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    El modelo de regresión ha mejorado bastante en el grupo de los que hacen ejercicio ya que el coeficiente de determinación ha aumentado bastante.\n    :::\n\n:::\n\n## Ejercicios propuestos\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}