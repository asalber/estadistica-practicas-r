{
  "hash": "2f64f1d5a290e6f13331c7849c6d4e4a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Distribuciones de probabilidad\nlang: es\n---\n\n\n\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n```r\nlibrary(tidyverse) \n# Incluye los siguientes paquetes:\n# - dplyr: para el preprocesamiento y manipulación de datos.\n# - ggplot2: para la representación gráfica.\n# - purrr: para aplicar funciones a vectores. \nlibrary(extraDistr) # para distribuciones de probabilidad adicionales.\nlibrary(knitr) # para el formateo de tablas.\nlibrary(kableExtra) # para personalizar el formato de las tablas.\n```\n\n:::{#exr-distribuciones-probabilidad-1}\nSea $X$ la variable que mide el resultado obtenido al lanzar un dado.\n\na.  ¿Qué tipo de modelo de distribución de probabilidad sigue $X$? Construir su función de probabilidad. \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Se trata de una [distribución uniforme discreta](https://es.wikipedia.org/wiki/Distribuci%C3%B3n_uniforme_discreta) $U(1, 6)$. Para calcular probabilidades con el modelo uniforme discreto se utiliza la función [`ddunif(x, min, max)`](https://www.rdocumentation.org/packages/extraDistr/versions/1.9.1/topics/DiscreteUniform) del paquete `extraDistr`, donde `min` es el mínimo valor que puede tomar la variable, `max` es el máximo valor que puede tomar la variable y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(extraDistr)\n    library(kableExtra)\n    x <- 1:6\n    f <- ddunif(x, 1, 6)\n    df <- data.frame(x, f)\n    df |> \n        kable() |> \n        kable_styling(full_width = F)\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:right;\"> x </th>\n       <th style=\"text-align:right;\"> f </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:right;\"> 1 </td>\n       <td style=\"text-align:right;\"> 0.1666667 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 2 </td>\n       <td style=\"text-align:right;\"> 0.1666667 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 3 </td>\n       <td style=\"text-align:right;\"> 0.1666667 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 4 </td>\n       <td style=\"text-align:right;\"> 0.1666667 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 5 </td>\n       <td style=\"text-align:right;\"> 0.1666667 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 6 </td>\n       <td style=\"text-align:right;\"> 0.1666667 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    :::\n\na.  Dibujar la gráfica de la función de probabilidad del modelo de probabilidad anterior.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = x, y = f)) +\n        geom_point(color = \"steelblue\") +\n        labs(title = \"Función de probabilidad uniforme U(1,6)\", x = \"Número obtenido\", y = \"Probabilidad\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-2-1.png){width=672}\n    :::\n    :::\n\n    :::\n\na.  Simular el experimento aleatorio del lanzamiento de un dado. Repetir el lanzamiento un millón de veces y dibujar el diagrama de barras de la distribución de frecuencias resultante. ¿Se parece a la distribución de probabilidad anterior?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    # Fijamos una semilla de aleatorización para obtener resultados reproducibles.\n    set.seed(123)\n    data.frame(x = rdunif(10^6, 1, 6))  |> \n        ggplot(aes(x = x)) +\n        geom_bar(aes(y = after_stat(count/sum(count))), fill = \"steelblue\") +\n        labs(title = \"Distribución de frecuencias del lanzamiento de un dado\", x = \"Número obtenido\", y = \"Frecuencia relativa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-3-1.png){width=672}\n    :::\n    :::\n\n\n    La distribución experimental obtenida es casi idéntica a la distribución teórica del modelo uniforme $U(1,6)$.\n    :::\n:::\n\n:::{#exr-distribuciones-probabilidad-2}\nUn test consta de 10 preguntas de opción múltiple con cuatro posibles respuestas para cada pregunta. \n\na.  ¿Qué tipo de modelo de distribución de probabilidad sigue la variable que mide el número de aciertos al responder todas las preguntas aleatoriamente? Construir su función de probabilidad. \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Se trata de una [distribución binomial](https://es.wikipedia.org/wiki/Distribuci%C3%B3n_binomial) $B(10, 0.25)$. Para calcular probabilidades con el modelo binomial se utiliza la función [`dbinom(x, n, p)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Binomial) del paquete `stats`, donde `n` es el número de repeticiones, `p` es la probabilidad de éxito, y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(kableExtra)\n    x <- 0:10\n    f <- dbinom(x, 10, 0.25)\n    df <- data.frame(x, f)\n    df |> \n        kable() |> \n        kable_styling(full_width = F)\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:right;\"> x </th>\n       <th style=\"text-align:right;\"> f </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:right;\"> 0 </td>\n       <td style=\"text-align:right;\"> 0.0563135 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 1 </td>\n       <td style=\"text-align:right;\"> 0.1877117 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 2 </td>\n       <td style=\"text-align:right;\"> 0.2815676 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 3 </td>\n       <td style=\"text-align:right;\"> 0.2502823 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 4 </td>\n       <td style=\"text-align:right;\"> 0.1459980 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 5 </td>\n       <td style=\"text-align:right;\"> 0.0583992 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 6 </td>\n       <td style=\"text-align:right;\"> 0.0162220 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 7 </td>\n       <td style=\"text-align:right;\"> 0.0030899 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 8 </td>\n       <td style=\"text-align:right;\"> 0.0003862 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 9 </td>\n       <td style=\"text-align:right;\"> 0.0000286 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 10 </td>\n       <td style=\"text-align:right;\"> 0.0000010 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    :::\n\na.  Dibujar la gráfica de la función de probabilidad del modelo de probabilidad anterior. ¿Cómo es la asimetría de la distribución de probabilidad? ¿Cómo afecta a la asimetría de la distribución el número de respuestas posibles en cada pregunta del test?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = x, y = f)) +\n        geom_point(color = \"steelblue\") +\n        labs(title = \"Función de probabilidad B(10,0.25)\", x = \"Número de preguntas acertadas\", y = \"Probabilidad\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-5-1.png){width=672}\n    :::\n    :::\n\n\n    La distribución es asimétrica hacia la derecha. A medida que aumenta el número de posibles respuestas, la probabilidad de acertar disminuye y la distribución binomial se hace más asimétrica hacia la derecha.\n    :::\n\na.  Dibujar la gráfica de la función de distribución del modelo de probabilidad anterior.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Para calcular probabilidades acumuladas con el modelo binomial se utiliza la función [`pbinom(x, n, p)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Binomial) del paquete `stats`, donde `n` es el número de repeticiones, `p` es la probabilidad de éxito, y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    df$F <- pbinom(x, 10, 0.25)\n    ggplot(df, aes(x = x, y = F)) +\n        geom_point(color = \"steelblue\") +\n        labs(title = \"Función de distribución B(10,0.25)\", x = \"Número de preguntas acertadas\", y = \"Probabilidad acumulada\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-6-1.png){width=672}\n    :::\n    :::\n\n\n    La distribución es asimétrica hacia la derecha.\n    :::\n\na.  ¿Cuál es la probabilidad de sacar 3 puntos o menos en el test si se contestan todas las preguntas al azar?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pbinom(3, 10, 0.25)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.7758751\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  ¿Cuál es la probabilidad de aprobar el test si se contestan todas las preguntas al azar?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    En este caso se trata de una probabilidad acumulada hacia la derecha, es decir, por encima del valor dado. Para ello hay que añadir el parámetro `lower.tail = FALSE` a la función `pbinom`. \n\n    :::{.callout-warning}\n    Las funciones de distribución en $R$ incluyen la probabilidad del valor dado cuando la cola de acumulación es hacia la izquierda, es decir, se calcula $P(X\\leq x)$, pero no lo incluyen cuando la cola de acumulación es hacia la derecha, es decir, se calcula $P(X>x)$.\n    :::\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pbinom(4, 10, 0.25, lower.tail = FALSE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.07812691\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code}\n    # o bien\n    1 - pbinom(4, 10, 0.25)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.07812691\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  ¿Cuál es la probabilidad de tener un notable si se contestan todas las preguntas al azar?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    El notable se corresponde con una nota de 7 u 8, por lo que hay que calcular la probabilidad $P(7\\leq X\\leq 8)$.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pbinom(8, 10, 0.25) - pbinom(6, 10, 0.25)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.003476143\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n:::\n\n:::{#exr-distribuciones-probabilidad-3}\nEl número medio de llamadas telefónicas que llegan a un servicio de teleasistencia es de 4 por minuto en horario laborable.\n\na.  ¿Qué tipo de modelo de distribución de probabilidad sigue la variable que mide el número de llamadas que llegan al servicio de teleasistencia en un minuto? Construir su función de probabilidad. \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Se trata de una [distribución de Poisson](https://es.wikipedia.org/wiki/Distribuci%C3%B3n_de_Poisson) $P(4)$. Para calcular probabilidades con el modelo Poisson se utiliza la función [`dpois(x, lambda)`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/Poisson) del paquete `stats`, donde `lambda` es el número medio de sucesos en el intervalo considerado y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(kableExtra)\n    x <- 0:15\n    f <- dpois(x, 4)\n    df <- data.frame(x, f)\n    df |> \n        kable() |> \n        kable_styling(full_width = F)\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:right;\"> x </th>\n       <th style=\"text-align:right;\"> f </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:right;\"> 0 </td>\n       <td style=\"text-align:right;\"> 0.0183156 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 1 </td>\n       <td style=\"text-align:right;\"> 0.0732626 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 2 </td>\n       <td style=\"text-align:right;\"> 0.1465251 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 3 </td>\n       <td style=\"text-align:right;\"> 0.1953668 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 4 </td>\n       <td style=\"text-align:right;\"> 0.1953668 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 5 </td>\n       <td style=\"text-align:right;\"> 0.1562935 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 6 </td>\n       <td style=\"text-align:right;\"> 0.1041956 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 7 </td>\n       <td style=\"text-align:right;\"> 0.0595404 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 8 </td>\n       <td style=\"text-align:right;\"> 0.0297702 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 9 </td>\n       <td style=\"text-align:right;\"> 0.0132312 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 10 </td>\n       <td style=\"text-align:right;\"> 0.0052925 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 11 </td>\n       <td style=\"text-align:right;\"> 0.0019245 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 12 </td>\n       <td style=\"text-align:right;\"> 0.0006415 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 13 </td>\n       <td style=\"text-align:right;\"> 0.0001974 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 14 </td>\n       <td style=\"text-align:right;\"> 0.0000564 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:right;\"> 15 </td>\n       <td style=\"text-align:right;\"> 0.0000150 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    :::\n\na.  Dibujar la gráfica de la función de probabilidad del modelo de probabilidad anterior. ¿Cómo es la asimetría de la distribución de probabilidad?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    ggplot(df, aes(x = x, y = f)) +\n        geom_point(color = \"steelblue\") +\n        labs(title = \"Función de probabilidad P(4)\", x = \"Número de llamadas en 1 minuto\", y = \"Probabilidad\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-11-1.png){width=672}\n    :::\n    :::\n\n    \n    La distribución es asimétrica hacia la derecha. \n    :::\n\na.  ¿Cuál es la probabilidad de que lleguen menos de 2 llamadas en un minuto?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    ppois(1, 4)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.09157819\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  Si la empresa que da el servicio tiene operadores para atener como máximo 30 llamadas cada 5 minutos, ¿cuál es la probabilidad de que en un intervalo de 5 minutos no se puedan atender todas las llamadas?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como el intervalo de tiempo ahora es de 5 minutos, el número medio de llamadas en este intervalo de tiempo es 4\\cdot 5 = 20, y por tanto, hay que trabajar con un modelo de Poisson $P(20)$.\n\n    Por otro lado, como ahora queremos calcular una probabilidad acumulada hacia la derechea, es decir, por encima del valor, hay que añadir el parámetro `lower.tail = FALSE` a la función `ppois`.\n    \n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    ppois(30, 20, lower.tail = FALSE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.01347468\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n:::\n\n:::{#exr-distribuciones-probabilidad-4}\nLa [ley de los casos raros](https://en.wikipedia.org/wiki/Poisson_limit_theorem) establece que la función de probabilidad de un modelo de Poison $P(\\lambda)$ se obtiene en el límite cuando $n$ tiende a $\\infty$ y $p$ tiende a $0$ de la función de probabilidad de un modelo Binomial $B(n,p)$, donde $\\lambda = np$.\n\na.  Aproximar un modelo binomial $B(10, 0.2)$ mediante el correspondiente modelo Poisson aplicando la ley de los casos raros y comparar las gráficas de las distribuciones de probabilidad de ambos modelos. ¿Es una buena aproximación?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Según la ley de los casos raros $B(10, 0.3) \\approx P(3)$.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(kableExtra)\n    library(tidyverse)\n    library(ggplot2)\n    x <- 0:10\n    fbinom <- dbinom(x, 10, 0.3)\n    fpois <- dpois(x, 3)\n    df <- data.frame(x, fbinom, fpois)\n    df  |> \n        pivot_longer(-x, names_to = \"Distribución\", values_to = \"Probabilidad\")  |> \n        ggplot(aes(x = x, y = Probabilidad, color = Distribución)) + \n        geom_point() +\n        labs(title = \"Función de probabilidad de los modelos B(10, 0.3) y P(3)\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-14-1.png){width=672}\n    :::\n    :::\n\n\n    Vamos a calcular el error en la aproximación.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    df  |> \n        mutate(error = abs(fbinom - fpois))  |> \n        summarize(error = sum(error))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n          error\n    1 0.1725254\n    ```\n    \n    \n    :::\n    :::\n\n\n    Así pues, la aproximación no es buena pues el error es mayor del 17%.\n    :::\n\na.  Aproximar $B(30, 0.1)$ mediante el correspondiente modelo Poisson aplicando la ley de los casos raros y comparar las gráficas de las distribuciones de probabilidad de ambos modelos. ¿Es una buena aproximación?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Según la ley de los casos raros $B(30, 0.1) \\approx P(3)$.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    x <- 0:30\n    fbinom <- dbinom(x, 30, 0.1)\n    fpois <- dpois(x, 3)\n    df <- data.frame(x, fbinom, fpois)\n    df  |> \n        pivot_longer(-x, names_to = \"Distribución\", values_to = \"Probabilidad\")  |> \n        ggplot(aes(x = x, y = Probabilidad, color = Distribución)) + \n        geom_point() +\n        labs(title = \"Función de probabilidad de los modelos B(30, 0.1) y P(3)\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-16-1.png){width=672}\n    :::\n    :::\n\n\n    Vamos a calcular el error en la aproximación.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    df  |> \n        mutate(error = abs(fbinom - fpois))  |> \n        summarize(error = sum(error))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n           error\n    1 0.05236218\n    ```\n    \n    \n    :::\n    :::\n\n\n    Ahora la aproximación es mucho mejor, ya que el error es menor del 5%.\n    :::\n\n\na.  Definir una función para repetir los procedimientos de los apartados anteriores para cualquier modelo binomial, y utilizarla para una binomial $B(100, 0.03)$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    casos_raros <- function (n, p){\n        # Definimos el rango del modelo binomial.\n        x <- 0:n\n        # Función de probabilidad del modelo binomial.\n        fbinom <- dbinom(x, n, p)\n        # Función de distribución del modelo Poisson equivalente.\n        fpois <- dpois(x, n*p)\n        # Creamos un data frame con las dos funciones de probabilidad.\n        df <- data.frame(x, fbinom, fpois)\n        # Dibujamos las gráficas de las funciones de probabilidad.\n        grafico <- df  |> \n            pivot_longer(-x, names_to = \"Distribución\", values_to = \"Probabilidad\")  |> \n            ggplot(aes(x = x, y = Probabilidad, color = Distribución)) + \n            geom_point() +\n            labs(title = paste0(\"Función de probabilidad de los modelos B(\", n, \",\", p, \") y P(\", n*p, \")\"))\n        # Calculamos el error de la aproximación.\n        error <- df  |> \n            mutate(error = abs(fbinom - fpois))  |> \n            summarize(error = sum(error))\n        return(list(grafico, error))\n    }\n    \n    casos_raros(100, 0.03) \n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [[1]]\n    ```\n    \n    \n    :::\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-18-1.png){width=672}\n    :::\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    \n    [[2]]\n           error\n    1 0.01521393\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  Dibujar una gráfica con los errores en las aproximaciones de un modelo binomial $B(n,p)$ mediante un modelo Poisson $P(3)$ para valores de $n desde $n=4$ hasta $n=100$. ¿A partir de que $n$ la ley de los casos raros da un error menor del 5%?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(purrr)\n    error_casos_raros <- function (n){\n        # Definimos el rango del modelo binomial.\n        x <- 0:n\n        # Función de probabilidad del modelo binomial.\n        fbinom <- dbinom(x, n, 3/n)\n        # Función de distribución del modelo Poisson equivalente.\n        fpois <- dpois(x, 3)\n        # Calculamos los errores para cada n.\n        error = abs(fbinom - fpois)\n        # Devolvemos la suma de los errores\n        return(sum(error))\n    }\n    \n    data.frame(n = 4:100)  |> \n        mutate(error = map_dbl(n, error_casos_raros))  |> \n        ggplot(aes(x = n, y = error)) +\n        geom_point(color = \"steelblue\") +\n        geom_hline(yintercept = 0.05, color = \"red\") +\n        labs(title = \"Error en la aproximación de un modelo B(n,p) con otro P(np)\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-19-1.png){width=672}\n    :::\n    :::\n\n    :::\n\n:::\n\n\n:::{#exr-distribuciones-probabilidad-5}\nLa vida media de un tipo de batería es de 50 días.\n\na.  ¿Qué tipo de modelo de distribución de probabilidad sigue la variable que mide la duración de este tipo de baterías? Construir su función de densidad.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Se trata de una [distribución exponencial](https://es.wikipedia.org/wiki/Distribuci%C3%B3n_exponencial) $Exp(1/50)$. Para calcular probabilidades con el modelo exponencial se utiliza la función [`dexp(x, lambda)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Exponential) del paquete `stats`, donde `lambda` es el inverso de la media y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    x <- seq(0,300,0.1)\n    f <- dexp(x, 1/50)\n    df <- data.frame(x, f)\n    ggplot(df, aes(x = x, y = f)) +\n        geom_line(color = \"steelblue\") +\n        labs(title = \"Función de densidad Exp(1/50)\", x = \"Días de duración\", y = \"Densidad de probabilidad\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-20-1.png){width=672}\n    :::\n    :::\n\n    :::\n\na.  Calcula la probabilidad de que la batería dure menos de 50 días.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Para calcular probabilidades con el modelo exponencial se utiliza la función [`pexp(x, lambda)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Exponential) del paquete `stats`, donde `lambda` es el inverso de la media y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pexp(50, 1/50)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.6321206\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  Calcula la probabilidad de que la batería dure más de 100 días.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    En este caso hay que calcular una probabilidad acumulada hacia la derecha, es decir, por encima del valor dado. Para ello hay añadir el parámetro `lower.tail = FALSE` a la función `pexp`.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pexp(100, 1/50, lower.tail = FALSE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.1353353\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  Calcula la probabilidad de que la batería dure entre 50 y 100 días.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pexp(100, 1/50) - pexp(50, 1/50)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.2325442\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  Calcular los cuartiles de la distribución del tiempo de duración de las baterías.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Para calcular percentiles con el modelo exponencial se utiliza la función [`qexp(x, lambda)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Exponential) del paquete `stats`, donde `lambda` es el inverso de la media y `x` es la probabilidad acumulada del percentil.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    cuartiles <- qexp(c(0.25, 0.5, 0.75), 1/50)\n    names(cuartiles) <- c(\"C1\", \"C2\", \"C3\")\n    cuartiles\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n          C1       C2       C3 \n    14.38410 34.65736 69.31472 \n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\n:::\n\n:::{#exr-distribuciones-probabilidad-6}\nSe sabe que el nivel de colesterol en hombres de una determinada población sigue una distribución Normal $N(220, 20)$ en mg/dl.\n\na.  Dibujar la función de densidad de este modelo. \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Para calcular densidades de probabilidad de una [distribución normal](https://es.wikipedia.org/wiki/Distribuci%C3%B3n_normal) se utiliza la función [`dnorm(x, mean, sd)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Normal) del paquete `stats`, donde `mean` es la media, `sd` es la desviación típica y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    x <- seq(160,280,0.1)\n    f <- dnorm(x, 220, 20)\n    df <- data.frame(x, f)\n    ggplot(df, aes(x = x, y = f)) +\n        geom_line(color = \"steelblue\") +\n        labs(title = \"Función de densidad N(220,20)\", x = \"Nivel de colesterol\", y = \"Densidad de probabilidad\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-25-1.png){width=672}\n    :::\n    :::\n\n    :::\n\na.  Dibujar la gráfica de la función de distribución del modelo de probabilidad anterior.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Para calcular probabilidades acumuladas con el modelo normal se utiliza la función [`pnorm(x, mean, sd)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Normal) del paquete `stats`, donde `mean` es la media, `sd` es la desviación típica y `x` es el valor de la variable.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    df$F <- pnorm(x, 220, 20)\n    ggplot(df, aes(x = x, y = F)) +\n        geom_line(color = \"steelblue\") +\n        labs(title = \"Función de distribución N(220,20)\", x = \"Nivel de colesterol\", y = \"Probabilidad acumulada\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-26-1.png){width=672}\n    :::\n    :::\n\n    :::\n\na.  Calcular la probabilidad de tener un nivel de colesterol por debajo de 220 mg/dl.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pnorm(220, 220, 20)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.5\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  Calcular la probabilidad de tener un nivel de colesterol por encima de 260 mg/dl.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    En este caso hay que calcular una probabilidad acumulada hacia la derecha, es decir, por encima del valor dado, y hay añadir el parámetro `lower.tail = FALSE` a la función `pnorm`.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pnorm(260, 220, 20, lower.tail = FALSE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.02275013\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n\na.  ¿Qué porcentaje de la población presentará un nivel de colesterol entre $\\mu-\\sigma$ y $\\mu+\\sigma$?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como $\\mu=200$ y $\\sigma=20$, se tiene $(\\mu-\\sigma, \\mu+\\sigma) = (200, 240)$.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pnorm(240, 220, 20) - pnorm(200, 220, 20)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.6826895\n    ```\n    \n    \n    :::\n    :::\n\n\n    Por tanto, habrá un 68.27 % de la población.\n    :::\n\na.  ¿Qué porcentaje de la población presentará un nivel de colesterol entre $\\mu-2\\sigma$ y $\\mu+2\\sigma$?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como $\\mu=200$ y $\\sigma=20$, se tiene $(\\mu-2\\sigma, \\mu+2\\sigma) = (180, 260)$.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pnorm(260, 220, 20) - pnorm(180, 220, 20)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.9544997\n    ```\n    \n    \n    :::\n    :::\n\n\n    Por tanto, habrá un 95.45 % de la población.\n    :::\n\na.  ¿Qué porcentaje de la población presentará un nivel de colesterol entre $\\mu-3\\sigma$ y $\\mu+3\\sigma$?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como $\\mu=200$ y $\\sigma=20$, se tiene $(\\mu-3\\sigma, \\mu+3\\sigma) = (160, 280)$.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    pnorm(280, 220, 20) - pnorm(160, 220, 20)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 0.9973002\n    ```\n    \n    \n    :::\n    :::\n\n\n    Por tanto, habrá un 99.73 % de la población.\n    :::\n\na.  Calcular el rango intercuartílico de la distribución.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Para calcular percentiles con el modelo normal se utiliza la función [`qnorm(x, mean, sd)`](https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Normal) del paquete `stats`, donde `mean` es la media, `sd` es la desviación típica y `x` es la probabilidad acumulada del percentil.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    qnorm(0.75, 220, 20) - qnorm(0.25, 220, 20)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 26.97959\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n:::\n\n:::{#exr-distribuciones-probabilidad-7}\nEl [teorema central del límite](https://es.wikipedia.org/wiki/Teorema_del_l%C3%ADmite_central) establece que la suma de $n$ variables aleatorias independientes, con media y varianza finitas, se aproxima a una distribución normal. En este ejercicio comprobaremos su certeza experimentalmente.\n\na.  Generar una muestra aleatoria de tamaño 1000000 de una variable aleatoria uniforme discreta U(1,10) y dibujar la gráfica de su distribución de frecuencias.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(ggplot2)\n    set.seed(123)\n    df <- data.frame(x1 = rdunif(10^6, 1, 10))  \n    ggplot(df, aes(x = x1)) +\n        geom_bar(aes(y = after_stat(count/sum(count))), fill = \"steelblue\") +\n        labs(title = \"Distribución de frecuencias U(1,10)\", x = \"X\", y = \"Frecuencia relativa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-33-1.png){width=672}\n    :::\n    :::\n\n    :::\n\na.  Generar otra muestra aleatoria de tamaño 1000000 de una variable aleatoria uniforme discreta U(1,10) y dibujar la gráfica de su distribución de frecuencias de la suma de esta variable y la anterior.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    df  |> \n        mutate(x2 = rdunif(10^6, 1, 10), suma = x1 + x2)  |> \n        ggplot(aes(x = suma)) +\n        geom_bar(aes(y = after_stat(count/sum(count))), fill = \"steelblue\") +\n        labs(title = \"Distribución de frecuencias de la suma de dos variables U(1,10) independientes\", x = \"Suma\", y = \"Frecuencia relativa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-34-1.png){width=672}\n    :::\n    :::\n\n    :::\n\na.  Definir una función que genere $n$ muestras independientes de tamaño 1000000 de una variable uniforme discreta $U(1,10)$ y devuelva su suma. Utilizar la función para dibujar el diagrama de barras de la distribución de frecuencias de la suma de 30 variables uniformes discretas $U(1,10)$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    distribucion_suma <- function(n) {\n        df <- data.frame(suma = rep(0, 10^6))\n        for (i in 1:n) {\n            df[[paste0(\"x\", i)]] <- rdunif(10^6, 1, 10)\n            df$suma <- df$suma + df[[paste0(\"x\", i)]]\n        }\n        return(df)\n    }\n    \n    ggplot(distribucion_suma(30), aes(x = suma)) + \n        geom_bar(aes(y = after_stat(count/sum(count))), fill = \"steelblue\") +\n        labs(title = paste0(\"Distribución de frecuencias de la suma de 30 variables U(1,10) independientes\"), x = \"Suma\", y = \"Frecuencia relativa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](06-distribuciones-probabilidad_files/figure-html/unnamed-chunk-35-1.png){width=672}\n    :::\n    :::\n\n    :::\n:::\n\n## Ejercicios propuestos\n\n:::{#exr-distribuciones-probabilidad-7}\nUna máquina de chips produce un 0.02% de chips defectuosos. Si la máquina produce 120 chips cada hora.\n\na. Calcular la probabilidad de que la máquina produzca algún chip defectuoso en 5 minutos.\n\na. Calcular la probabilidad de que produzca más de 1 chip defectuoso en 10 minutos.\n\na. Calcular la probabilidad de que produzca entre 1 y 3 chips defectuosos (ambos incluidos) en 10 minutos. \n:::\n\n:::{#exr-distribuciones-probabilidad-8}\nLas ventas medias de un libro en un comercio electrónico son de 15 unidades diarias. \n\na. ¿Cuál es la probabilidad de que un día concreto no se venda ningún libro?\n\na. ¿Cuál es la probabilidad de que un día concreto se vendan entre 10 y 20 libros?\n\na. Si en el almacén que hace los envíos se dispone de un stock de 125 libros, ¿cuál es la probabilidad de que no puedan satisfacer todos los pedidos en una semana?\n:::\n\n:::{#exr-distribuciones-probabilidad-9}\nDibujar las gráficas de las funciones de probabilidad y distribución de una variable geométrica $Geom(0.2)$.\n:::\n\n:::{#exr-distribuciones-probabilidad-10}\nGenerar 10 muestras aleatorias de una distribución y calcular la suma de sus cuadrados. Dibujar el diagrama de barras de la distribución de frecuencias de la muestra obtenida sumando los cuadrados. Compararla con la función de probabilidad de una distribución Chi-cuadrado con 10 grados de libertad.\n:::\n\n:::{#exr-distribuciones-probabilidad-11}\nDibujar las gráficas de las funciones de densidad y distribución de una variable T de Student $T(12)$.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}