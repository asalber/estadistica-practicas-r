{
  "hash": "aea9263b9c6e1dd9b77819048155dae2",
  "result": {
    "markdown": "---\ntitle: Intervalos de confianza para medias y proporciones de una población\nknitr: \n    opts_chunk: \n      R.options:\n        warning: false\nlang: es\n---\n\n\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n```r\nlibrary(tidyverse)\n# Incluye los siguientes paquetes:\n# - dplyr: para el preprocesamiento y manipulación de datos.\n# - ggplot2: para la representación gráfica.\n# - purrr: para aplicar funciones a vectores.\nlibrary(broom) # para convertir las listas con los resúmenes de los modelos de regresión a formato organizado.\nlibrary(tidymodels) # para realizar contrastes de hipótesis en formato tidy.\nlibrary(samplingbook) # para el cálculo de tamaños muestrales.\nlibrary(knitr) # para el formateo de tablas.\n```\n\n:::{#exr-intervalo-media-principio-activo}\nSe sabe que para que un fármaco sea efectivo, la concentración de su principio activo debe ser de al menos $16$ mg/mm$^3$. Una farmacia va a comprar un lote de este medicamento, pero antes quiere asegurarse de que los medicamentos del lote son efectivos y para ello analiza la concentración de principio activo en una muestra aleatoria de $10$ envases tomados del lote, obteniendo los siguientes resultados en mg/mm$^{3}$:\n\n$$\n17.6 \\quad 19.2 \\quad 21.3 \\quad 15.1 \\quad 17.6 \\quad 18.9 \\quad 16.2 \\quad 18.3 \\quad 19.0 \\quad 16.4\n$$\n\na.  Crear un conjunto de datos con los datos de la muestra.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-1_07fb818a119de69642d1894cb463b2e1'}\n    \n    ```{.r .cell-code}\n    df <- data.frame(concentracion = c(17.6, 19.2, 21.3, 15.1, 17.6, 18.9, 16.2, 18.3, 19.0, 16.4 ))\n    ```\n    :::\n\n\n    :::\n\na.  Calcular la concentración media de principio activo de la muestra. ¿Puede afirmarse que los medicamentos del lote son efectivos?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-2_3777170f6762eda5bc08fc0c1c748188'}\n    \n    ```{.r .cell-code}\n    mean(df$concentracion)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 17.96\n    ```\n    :::\n    :::\n\n\n\n    A pesar de la concentración media está por encima de $16$ mg/mm$^3$, se trata de una estimación puntual, y por tanto, no podemos garantizar que la media poblacional esté por encima de $16$ mg/mm$^3$. ¿Puede afirmarse con este nivel de confianza que los medicamentos del lote son efectivos?\n    :::\n\na.  Calcular el intervalo de confianza para la media de la concentración del lote con nivel de confianza del $95\\%$ (nivel de significación $\\alpha =0.05$). ¿Puede afirmarse ahora que los medicamentos del lote son efectivos?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para calcular el intervalo de confianza para la media de una población podemos utilizar la función [`t.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test) del paquete `stats`.\n\n    Si queremos mostrar la salida del test en formato de tabla podemos utilizar la función `tidy` del paquete [`broom`](https://broom.tidymodels.org/index.html).\n\n    También podemos usar la función [`t_test`](https://infer.tidymodels.org/reference/t_test.html?q=t_test#null) de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-3_880e207fe9e833bec93f28745f6561b4'}\n    \n    ```{.r .cell-code}\n    t1 <- t.test(df$concentracion)\n    t1$conf.int\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 16.68158 19.23842\n    attr(,\"conf.level\")\n    [1] 0.95\n    ```\n    :::\n    :::\n\n\n\n    Para mostrar la salida en formato de tabla.\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-4_6a5e06b8e1dedc96f64d460bd1eb1ed3'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --\n    v dplyr     1.1.4     v readr     2.1.5\n    v forcats   1.0.0     v stringr   1.5.1\n    v ggplot2   3.4.4     v tibble    3.2.1\n    v lubridate 1.9.3     v tidyr     1.3.0\n    v purrr     1.0.2     \n    -- Conflicts ------------------------------------------ tidyverse_conflicts() --\n    x dplyr::filter() masks stats::filter()\n    x dplyr::lag()    masks stats::lag()\n    i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    tidy(t1) |> \n        select(estimate, conf.low, conf.high) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| conf.low| conf.high|\n    |--------:|--------:|---------:|\n    |    17.96| 16.68158|  19.23842|\n    :::\n    :::\n\n\n\n    ## `tidymodels`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/message - false_b25fe36714bdb94307ace6005e7585b0'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    -- Attaching packages -------------------------------------- tidymodels 1.1.1 --\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    v dials        1.2.1     v rsample      1.2.0\n    v infer        1.0.6     v tune         1.1.2\n    v modeldata    1.3.0     v workflows    1.1.4\n    v parsnip      1.2.0     v workflowsets 1.0.1\n    v recipes      1.0.9     v yardstick    1.3.0\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    -- Conflicts ----------------------------------------- tidymodels_conflicts() --\n    x scales::discard() masks purrr::discard()\n    x dplyr::filter()   masks stats::filter()\n    x recipes::fixed()  masks stringr::fixed()\n    x dplyr::lag()      masks stats::lag()\n    x yardstick::spec() masks readr::spec()\n    x recipes::step()   masks stats::step()\n    * Learn how to get started at https://www.tidymodels.org/start/\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    df |> \n        t_test(response = concentracion) |> \n        select(estimate, lower_ci, upper_ci) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| lower_ci| upper_ci|\n    |--------:|--------:|--------:|\n    |    17.96| 16.68158| 19.23842|\n    :::\n    :::\n\n\n    :::\n\n    Como el intervalo entero está por encima de $16$ mg/mm$^3$, podemos afirmar con una confianza del $95\\%$ que la concentración media de principio activo del lote está por encima de $16$ mg/mm$^3$ y por tanto podemos concluir que los medicamentos del lote son efectivos.\n    :::\n\na.  ¿Puede afirmarse que los medicamentos del lote son efectivos con un $99\\%$ de confianza?\n\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-6_eeff58e06ed905d69565c1fda32cba10'}\n    \n    ```{.r .cell-code}\n    t2 <- t.test(df$concentracion, conf.level = 0.99)\n    t2$conf.int\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 16.1234 19.7966\n    attr(,\"conf.level\")\n    [1] 0.99\n    ```\n    :::\n    :::\n\n\n\n    Como el intervalo entero sigue estando por encima de $16$ mg/mm$^3$, podemos afirmar con una confianza del $99\\%$ que los medicamentos del lote son efectivos.\n    :::\n\na.  Si definimos la precisión del intervalo como la inversa de su amplitud, ¿cómo afecta a la precisión del intervalo de confianza el tomar niveles de significación cada vez más altos? ¿Cuál puede ser la explicación?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-7_ce3efafb58749f810d251960c19cdcf4'}\n    \n    ```{.r .cell-code}\n    cat(paste0(\"Amplitud intervalo 95%: \", t1$conf.int[2] - t1$conf.int[1]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Amplitud intervalo 95%: 2.55684921520655\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    cat(paste0(\"Amplitud intervalo 99%: \", t2$conf.int[2] - t2$conf.int[1]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Amplitud intervalo 99%: 3.67319282263829\n    ```\n    :::\n    :::\n\n\n\n    Como se ve, al aumentar el nivel de confianza del intervalo, la precisión disminuye. Ello es debido a que para tener más confianza de capturar el verdadero valor de la media en el intervalo, debemos hacer mayor el intervalo.\n    :::\n\na.  ¿Qué tamaño muestral sería necesario para obtener una estimación del contenido medio de principio activo con un margen de error de $\\pm 0.5$ mg/mm$^3$ y una confianza del 95%?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    El tamaño muestral necesario para construir un intervalo de confianza para la media depende del nivel de confianza deseado ($0.95$ en este caso), del error o semiamplitud del intervalo deseado ($0.5$ en este caso) y de la desviación típica poblacional, que no se conoce, pero se puede estimar mediante la cuasidesviación típica muestral.\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-8_585f8c90ca1a5b96f898a2660e285a06'}\n    \n    ```{.r .cell-code}\n    library(samplingbook)\n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Loading required package: pps\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Loading required package: sampling\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Loading required package: survey\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Loading required package: grid\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Loading required package: Matrix\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    \n    Attaching package: 'Matrix'\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    The following objects are masked from 'package:tidyr':\n    \n        expand, pack, unpack\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Loading required package: survival\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    \n    Attaching package: 'survival'\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    The following objects are masked from 'package:sampling':\n    \n        cluster, strata\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    \n    Attaching package: 'survey'\n    ```\n    :::\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    The following object is masked from 'package:graphics':\n    \n        dotchart\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    sample.size.mean(e = 0.5, S = sd(df$concentracion), level = 0.95)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    sample.size.mean object: Sample size for mean estimate\n    Without finite population correction: N=Inf, precision e=0.5 and standard deviation S=1.7871\n    \n    Sample size needed: 50\n    ```\n    :::\n    :::\n\n\n    :::\n:::\n\n:::{#exr-intervalo-media-grasa-leche}\nUna central de productos lácteos recibe diariamente la leche de dos granjas $X$ e $Y$. Para analizar la calidad de la leche, durante una temporada, se controla el porcentaje de materia grasa de la leche que proviene de ambas granjas, con los siguientes resultados:\n\n$$\n\\begin{array}{c|c}\nX & Y \\\\\n\\hline\n\\begin{array}[t]{rr}\n3.4 & 3.4 \\\\\n3.2 & 3.5 \\\\\n3.3 & 3.3 \\\\\n3.2 & 3.2 \\\\\n3.3 & 3.0 \\\\\n3.1 & 3.2 \\\\\n\\end{array}\n&\n\\begin{array}[t]{rr}\n2.8 & 2.9 \\\\\n3.0 & 3.2 \\\\\n3.2 & 3.1 \\\\\n2.9 & 2.9 \\\\\n3.1 & 3.2 \\\\\n2.9 & 3.1 \\\\\n3.3 & 3.2 \\\\\n3.2 & 3.3 \\\\\n\\end{array}\n\\end{array}\n$$\n\n\na.  Crear un conjunto de datos con los datos de la muestra.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-9_3b5ac86d49e0bec6b19fba93f231b7f1'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- tibble(\n        grasa = c(3.4, 3.2, 3.3, 3.2, 3.3, 3.1, 3.4, 3.5, 3.3, 3.2, 3.0, 3.2, 2.8, 3.0, 3.2, 2.9, 3.1, 2.9, 3.3, 3.2, 2.9, 3.2, 3.1, 2.9, 3.2, 3.1, 3.2, 3.3),\n        granja = factor(c(rep(\"X\", 12), rep(\"Y\", 16)))\n    )\n    ```\n    :::\n\n\n    :::\n\na.  Calcular el contenido medio de materia grasa de la muestra de leche cada granja y los respectivos intervalos de confianza con un $95\\%$ de confianza. Dibujar los intervalos de confianza obtenidos.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para calcular el intervalo de confianza para la media de una población podemos utilizar la función [`t.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test) del paquete `stats`. \n\n    También podemos usar la función `t_test` de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n\n    Otra opción es utilizar la función [`mean_ci`](https://www.rdocumentation.org/packages/qwraps2/versions/0.5.2/topics/mean_ci) del paquete `qwraps2`.\n    :::\n    \n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-10_ffa21b73d6c0a701680ae856e4a05c06'}\n    \n    ```{.r .cell-code}\n    library(knitr)\n    df |> \n        group_by(granja) |>\n        summarise(\"Media\" = mean(grasa, na.rm = T), \n        \"IC 95% Inf\" = t.test(grasa)$conf.int[1], \n        \"IC 95% Sup\" = t.test(grasa)$conf.int[2]) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |granja |    Media| IC 95% Inf| IC 95% Sup|\n    |:------|--------:|----------:|----------:|\n    |X      | 3.258333|   3.170719|   3.345948|\n    |Y      | 3.081250|   2.995950|   3.166550|\n    :::\n    :::\n\n\n\n    Otra opción es anidando los data frames de cada granja y aplicar el test t para cada grupo.\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-11_5dc63d28670b37aa3e7dd810e813bb6a'}\n    \n    ```{.r .cell-code}\n    tabla_ic <- df |> \n        nest(data = -granja) |> \n        mutate(test = map(data, ~ tidy(t.test(.x$grasa)))) |> \n        unnest(test) |> \n        select(granja, estimate, conf.low, conf.high) \n        \n    tabla_ic |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |granja | estimate| conf.low| conf.high|\n    |:------|--------:|--------:|---------:|\n    |X      | 3.258333| 3.170719|  3.345948|\n    |Y      | 3.081250| 2.995950|  3.166550|\n    :::\n    :::\n\n\n\n    ## `tidymodels`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-12_fb2961de24e460699c90efe9a1da3e5a'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n        nest(data = -granja) |> \n        mutate(test = map(data, ~ t_test(x = .x, response = grasa))) |> \n        unnest(test) |> \n        select(granja, estimate, lower_ci, upper_ci) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |granja | estimate| lower_ci| upper_ci|\n    |:------|--------:|--------:|--------:|\n    |X      | 3.258333| 3.170719| 3.345948|\n    |Y      | 3.081250| 2.995950| 3.166550|\n    :::\n    :::\n\n\n    :::\n\n    Ahora dibujamos los intervalos de confianza.\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-13_771583454e1f92dac60e18ce9b2f1f4f'}\n    \n    ```{.r .cell-code}\n    tabla_ic  |> \n        ggplot(aes(x = granja, y = estimate, color = granja)) +\n        geom_point(size = 3) +\n        geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +\n        labs(title = \"Intervalos de confianza del 95% para la media\", x = \"Granja\", y = \"Porcentaje de grasa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](07-intervalos-confianza-una-poblacion_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-pos='H'}\n    :::\n    :::\n\n\n    :::\n\n\na.  A la vista de los intervalos de confianza obtenidos ¿Existen diferencias estadísticamente significativas entre los contenidos medios de grasa de la leche de las dos granjas? En tal caso, ¿qué granja produce leche con más grasa?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como los intervalos no se solapan, es decir, no tienen valores en común, podemos concluir que los contenidos medios de grasa de las leches de las dos granjas son significativamente diferentes con un $95\\%$ de confianza. Además se aprecia que el intervalo de la granja $X$ tiene valores mayores que el de la granja $Y$, por lo que la leche de la granja $X$ tiene más contenido de grasa que la de la granja $Y$.\n    :::\n\na.  Repetir los cálculos anteriores tomando una confianza del $99\\%$. ¿Existen diferencias estadísticamente significativas entre el contenido medio de grasa de las leches de las dos granjas con este nivel de confianza?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-14_edf68447ad5f6b6b0094d97f2448e39d'}\n    \n    ```{.r .cell-code}\n    tabla_ic_99 <- df |> \n        nest(data = -granja) |> \n        mutate(test = map(data, ~ tidy(t.test(.x$grasa, conf.level = 0.99)))) |> \n        unnest(test) |> \n        select(granja, estimate, conf.low, conf.high) \n        \n    tabla_ic_99 |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |granja | estimate| conf.low| conf.high|\n    |:------|--------:|--------:|---------:|\n    |X      | 3.258333| 3.134701|  3.381966|\n    |Y      | 3.081250| 2.963324|  3.199176|\n    :::\n    :::\n\n\n\n    ## `tidymodels`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-15_ba1100a3ec031a59c11999027ce9f528'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n        nest(data = -granja) |> \n        mutate(test = map(data, ~ t_test(x = .x, response = grasa, conf_level = 0.99))) |> \n        unnest(test) |> \n        select(granja, estimate, lower_ci, upper_ci) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |granja | estimate| lower_ci| upper_ci|\n    |:------|--------:|--------:|--------:|\n    |X      | 3.258333| 3.134701| 3.381966|\n    |Y      | 3.081250| 2.963324| 3.199176|\n    :::\n    :::\n\n\n    :::\n\n    Ahora dibujamos los intervalos de confianza.\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-16_7d1833e60866c438f49f78946b2b220b'}\n    \n    ```{.r .cell-code}\n    tabla_ic_99  |> \n        ggplot(aes(x = granja, y = estimate, color = granja)) +\n        geom_point(size = 3) +\n        geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +\n        labs(title = \"Intervalos de confianza del 99% para la media\", x = \"Granja\", y = \"Porcentaje de grasa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](07-intervalos-confianza-una-poblacion_files/figure-pdf/unnamed-chunk-16-1.pdf){fig-pos='H'}\n    :::\n    :::\n\n\n\n    Como se ve, ahora los dos intervalos se solapan y por tanto las medias del contenido de grasa de las leches de las dos granjas podrían ser iguales. Por tanto, no existen diferencias estadísticamente significativas entre el contenido medio de grasa de las leches de las dos granjas con un $99º%$ de confianza.\n    :::\n:::\n\n:::{#exr-uso-biblioteca}\nEl conjunto de datos [`biblioteca.csv`](https://aprendeconalf.es/estadistica-practicas-r/datos/biblioteca.csv) contiene los resultados de una encuesta realizada en una universidad, sobre si el alumnado utiliza habitualmente (al menos una vez a la semana) la biblioteca.\n\na.  Crear conjunto de datos con los datos de la muestra a partir del fichero [`biblioteca.csv`](https://aprendeconalf.es/estadistica-practicas-r/datos/biblioteca.csv).\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-17_01486fe09e7cdce702b9a765341b137a'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- read_csv(\"https://aprendeconalf.es/estadistica-practicas-r/datos/biblioteca.csv\")\n    ```\n    :::\n\n\n    :::\n\na.  Calcular el intervalo de confianza con $\\alpha=0.01$ para la proporción del alumnado que utiliza habitualmente la biblioteca. ¿Cómo es la precisión del intervalo?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para calcular el intervalo de confianza para la proporción de una población podemos utilizar la función [`prop.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/prop.test) del paquete `stats`.\n\n    Si queremos mostrar la salida del test en formato de tabla podemos utilizar la función `tidy` del paquete [`broom`](https://broom.tidymodels.org/index.html).\n\n    También podemos usar la función [`prop_test`](https://infer.tidymodels.org/reference/prop_test.html) de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    \n    :::{.panel-tabset}\n    ## `stats`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-18_a847310afe516fb2b8c4c98189697e7a'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    frec <- table(df$respuesta)\n    tidy(prop.test(frec[\"si\"], nrow(df), conf.level = 0.99)) |> \n    select(estimate, conf.low, conf.high) |> \n    kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |  estimate| conf.low| conf.high|\n    |---------:|--------:|---------:|\n    | 0.4705882| 0.261705| 0.6896622|\n    :::\n    :::\n\n\n\n    ## `tidymodels`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-19_f147288c58d947fde017f28298bc76d6'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    library(knitr)\n    df  |> \n        prop_test(response = respuesta, conf_level = 0.99) |> \n        mutate(estimate = nrow(df[df$respuesta == \"si\", ]) / nrow(df)) |> \n        select(estimate, lower_ci, upper_ci) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |  estimate|  lower_ci| upper_ci|\n    |---------:|---------:|--------:|\n    | 0.4705882| 0.3103378| 0.738295|\n    :::\n    :::\n\n\n    :::\n\n    Se trata de un intervalo poco preciso, ya que su amplitud es bastante grande.\n    :::\n\na.  ¿Qué tamaño muestral sería necesario para obtener una estimación de la proporción de alumnos que utilizan regularmente la biblioteca con un margen de error de un $1\\%$ y una confianza del $95\\%$? \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    El tamaño muestral necesario para construir un intervalo de confianza para la media depende del nivel de confianza deseado ($0.95$ en este caso), del error o semiamplitud del intervalo deseado ($0.01$ en este caso) y de proporción poblacional, que no se conoce, pero se puede estimar mediante la proporción muestral.\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-20_d1a8a910193e1200d3fdb8a908c242a8'}\n    \n    ```{.r .cell-code}\n    library(samplingbook)\n    sample.size.prop(e = 0.01, P = frec[\"si\"]/nrow(df), level = 0.95)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    sample.size.prop object: Sample size for proportion estimate\n    Without finite population correction: N=Inf, precision e=0.01 and expected proportion P=0.4706\n    \n    Sample size needed: 9571\n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Calcular los intervalo de confianza para las proporciones de chicas y chicos que utilizan regularmente la biblioteca. ¿Existe una diferencia estadísticamente significativa entre la proporción de chicas y chicos que utilizan regularmente la biblioteca? En tal caso, ¿quiénes utilizan más la biblioteca?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## `stats`\n    \n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-21_fe7c5f703c5b4ad4a542b0d4ce036969'}\n    \n    ```{.r .cell-code}\n    df |> \n        group_by(sexo) |> \n        count(respuesta) |> \n        mutate(test = map(n, \\(x) tidy(prop.test(x, sum(n))))) |>     \n        unnest(test) |>\n        filter(respuesta == \"si\") |> \n        select(sexo, respuesta, n, estimate, conf.low, conf.high) |>  \n        kable() \n    ```\n    \n    ::: {.cell-output-display}\n    |sexo |respuesta |  n|  estimate|  conf.low| conf.high|\n    |:----|:---------|--:|---------:|---------:|---------:|\n    |H    |si        |  3| 0.1875000| 0.0497313| 0.4630766|\n    |M    |si        | 13| 0.7222222| 0.4640580| 0.8928742|\n    :::\n    :::\n\n\n\n    ## `tidymodels`\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-22_b1696071942c6a06f7e2cdf57806a490'}\n    \n    ```{.r .cell-code}\n    df |> \n        nest(data = -sexo) |>  \n        mutate(test = map(data, ~ prop_test(x = .x, response = respuesta, success = \"si\"))) |>  \n        mutate(estimate = map(data, ~ nrow(.x[.x$respuesta == \"si\", ]) / nrow(.x))) |>    \n        unnest(c(test, estimate)) |>\n        select(sexo, estimate, lower_ci, upper_ci) |>  \n        kable() \n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    No `p` argument was hypothesized, so the test will assume a null hypothesis `p\n    = .5`.\n    No `p` argument was hypothesized, so the test will assume a null hypothesis `p\n    = .5`.\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    |sexo |  estimate|  lower_ci|  upper_ci|\n    |:----|---------:|---------:|---------:|\n    |H    | 0.1875000| 0.0497313| 0.4630766|\n    |M    | 0.7222222| 0.4640580| 0.8928742|\n    :::\n    :::\n\n\n    :::\n\n    Como los intervalos de confianza para las proporciones de chicos y chicas que utilizan regularmente la biblioteca no se solapan, es decir, no tienen valores en común, podemos concluir que existe una diferencia estadísticamente significativa entre ambas proporciones con un $95\\%$ de confianza. Como además el intervalo de confianza para la proporción de chicas está claramente por encima del de chicos, se concluye que hay más chicas utilizan regularmente la biblioteca.\n    :::\n:::\n\n:::{#exr-intencion-voto}\nEn un sondeo preelectoral se ha tomado una muestra de $500$ personas y se ha observado que $220$ votarían al partido $A$ y $180$ votarían al partido $B$.\n\na.  Calcular el intervalo de confianza para el porcentaje de voto al partido $A$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-23_6432ed3853cad4841fdbec8b809b981c'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    tidy(prop.test(220, 500)) |> \n    select(estimate, conf.low, conf.high) |> \n    mutate(across(everything(), ~ .x * 100)) |> \n    kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| conf.low| conf.high|\n    |--------:|--------:|---------:|\n    |       44|   39.613|  48.48059|\n    :::\n    :::\n\n\n    :::\n\na.  Calcular el intervalo de confianza para el porcentaje de voto al partido $B$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n\n    ::: {.cell hash='07-intervalos-confianza-una-poblacion_cache/pdf/unnamed-chunk-24_8c6d8e3615f0a8e7131463fb5c4c223b'}\n    \n    ```{.r .cell-code}\n    tidy(prop.test(180, 500)) |> \n    select(estimate, conf.low, conf.high) |> \n    mutate(across(everything(), ~ .x * 100)) |> \n    kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| conf.low| conf.high|\n    |--------:|--------:|---------:|\n    |       36| 31.81744|  40.40109|\n    :::\n    :::\n\n\n    :::\n\na.  A la vista de los intervalos de confianza, ¿se puede asegurar con un $95\\%$ de confianza qué partido ganará las elecciones?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Como ambos intervalos se solapan, no existe una diferencia estadísticamente significativa entre los porcentajes de votos a ambos partidos, y por tanto, no se puede asegurar con un $95\\%$ de confianza qué partido ganará las elecciones.\n    :::\n:::\n\n## Ejercicios propuestos\n\n:::{#exr-intervalos-confianza-1-poblacion-neonatos}\nEl conjunto de datos [`neonatos`](https://aprendeconalf.es/estadistica-practicas-r/datos/neonatos.csv) contiene información sobre una muestra de 320 recién nacidos en un hospital durante un año que cumplieron el tiempo normal de gestación. \n\na.  Calcular el intervalo de confianza del $99\\%$ para el peso medio de los recién nacidos. ¿Entre qué valores estará el\npeso medio?\n\na.  Calcular el intervalo de confianza para la puntuación media del Apgar al minuto de nacer y compararlo con el de la\npuntuación Apgar a los 5 minutos. ¿Existe una diferencia estadísticamente significativa entre las medias de las dos puntuaciones?\n\na.  Calcular el intervalo de confianza para el porcentaje de niños con peso menor o igual que $2.5$ Kg en el grupo de\nlas madres que han fumado durante el embarazo y en el de las que no. ¿Podemos afirmar con un $95\\%$ de confianza que el que la madre fume influye significativamente en el peso de los recién nacidos?\n:::\n\n:::{#exr-intervalos-confianza-1-poblacion-piezas-defectuosas}\nEn una fábrica de componentes electrónicos, hay dos máquinas que producen un mismo tipo de chips. Se ha tomado una muestra de chips de cada máquina y se ha observado que en la primera máquina hubo 12 chips defectuosos de un total de 200, mientras que en la segunda máquina hubo un total de 10 chips defectuosos de un total de 300. ¿Se puede afirmar con un $90\\%$ de confianza que la segunda máquina produce menos chips defectuosos que la primera?\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}