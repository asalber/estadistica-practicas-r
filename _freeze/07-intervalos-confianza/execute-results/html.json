{
  "hash": "1caa3a593581561d7a86fac0a51cdc1d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Intervalos de confianza\nknitr: \n    opts_chunk: \n      R.options:\n        warning: false\nlang: es\n---\n\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n```r\nlibrary(tidyverse)\n# Incluye los siguientes paquetes:\n# - dplyr: para el preprocesamiento y manipulación de datos.\n# - ggplot2: para la representación gráfica.\n# - purrr: para aplicar funciones a vectores. \nlibrary(samplingbook) # para el cálculo de tamaños muestrales.\nlibrary(knitr) # para el formateo de tablas.\nlibrary(kableExtra) # para personalizar el formato de las tablas.\n```\n\n:::{#exr-intervalo-media-principio-activo}\nSe sabe que para que un fármaco sea efectivo, la concentración de su principio activo debe ser de al menos $16$ mg/mm$^3$. Una farmacia va a comprar un lote de este medicamento, pero antes quiere asegurarse de que los medicamentos del lote son efectivos y para ello analiza la concentración de principio activo en una muestra aleatoria de $10$ envases tomados del lote, obteniendo los siguientes resultados en mg/mm$^{3}$:\n\n$$\n17.6 \\quad 19.2 \\quad 21.3 \\quad 15.1 \\quad 17.6 \\quad 18.9 \\quad 16.2 \\quad 18.3 \\quad 19.0 \\quad 16.4\n$$\n\na.  Crear un conjunto de datos con los datos de la muestra.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    df <- data.frame(concentracion = c(17.6, 19.2, 21.3, 15.1, 17.6, 18.9, 16.2, 18.3, 19.0, 16.4 ))\n    ```\n    :::\n\n    :::\n\na.  Calcular la concentración media de principio activo de la muestra. ¿Puede afirmarse que los medicamentos del lote son efectivos?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    mean(df$concentracion)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 17.96\n    ```\n    \n    \n    :::\n    :::\n\n\n    A pesar de la concentración media está por encima de $16$ mg/mm$^3$, se trata de una estimación puntual, y por tanto, no podemos garantizar que la media poblacional esté por encima de $16$ mg/mm$^3$. ¿Puede afirmarse con este nivel de confianza que los medicamentos del lote son efectivos?\n    :::\n\na.  Calcular el intervalo de confianza para la media de la concentración del lote con nivel de confianza del $95\\%$ (nivel de significación $\\alpha =0.05$). ¿Puede afirmarse ahora que los medicamentos del lote son efectivos?\n\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    t1 <- t.test(df$concentracion)\n    t1$conf.int\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 16.68158 19.23842\n    attr(,\"conf.level\")\n    [1] 0.95\n    ```\n    \n    \n    :::\n    :::\n\n\n    Como el intervalo entero está por encima de $16$ mg/mm$^3$, podemos afirmar con una confianza del $95\\%$ que la concentración media de principio activo del lote está por encima de $16$ mg/mm$^3$ y por tanto podemos concluir que los medicamentos del lote son efectivos.\n    :::\n\na.  ¿Puede afirmarse que los medicamentos del lote son efectivos con un $99\\%$ de confiaza?\n\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    t2 <- t.test(df$concentracion, conf.level = 0.99)\n    t2$conf.int\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    [1] 16.1234 19.7966\n    attr(,\"conf.level\")\n    [1] 0.99\n    ```\n    \n    \n    :::\n    :::\n\n\n    Como el intervalo entero sigue estando por encima de $16$ mg/mm$^3$, podemos afirmar con una confianza del $99\\%$ que los medicamentos del lote son efectivos.\n    :::\n\na.  Si definimos la precisión del intervalo como la inversa de su amplitud, ¿cómo afecta a la precisión del intervalo de confianza el tomar niveles de significación cada vez más altos? ¿Cuál puede ser la explicación?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    cat(paste0(\"Amplitud intervalo 95%: \", t1$conf.int[2] - t1$conf.int[1]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    Amplitud intervalo 95%: 2.55684921520655\n    ```\n    \n    \n    :::\n    \n    ```{.r .cell-code}\n    cat(paste0(\"Amplitud intervalo 99%: \", t2$conf.int[2] - t2$conf.int[1]))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    Amplitud intervalo 99%: 3.67319282263829\n    ```\n    \n    \n    :::\n    :::\n\n\n    Como se ve, al aumentar el nivel de confianza del intervalo, la precisión disminuye. Ello es debido a que para tener más confianza de capturar el verdadero valor de la media en el intervalo, debemos hacer mayor el intervalo.\n    :::\n\na.  ¿Qué tamaño muestral sería necesario para obtener una estimación del contenido medio de principio activo con un margen de error de $\\pm 0.5$ mg/mm$^3$ y una confianza del 95%?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    El tamaño muestral necesario para construir un intervalo de confianza para la media depende del nivel de confianza deseado ($0.95$ en este caso), del error o semiamplitud del intervalo deseado ($0.5$ en este caso) y de la desviación típica poblacional, que no se conoce, pero se puede estimar mediante la cuasidesviación típica muestral.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(samplingbook)\n    sample.size.mean(e = 0.5, S = sd(df$concentracion), level = 0.95)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    \n    ```\n    \n    sample.size.mean object: Sample size for mean estimate\n    Without finite population correction: N=Inf, precision e=0.5 and standard deviation S=1.7871\n    \n    Sample size needed: 50\n    ```\n    \n    \n    :::\n    :::\n\n    :::\n:::\n\n:::{#exr-intervalo-media-grasa-leche}\nUna central de productos lácteos recibe diariamente la leche de dos granjas $X$ e $Y$. Para analizar la calidad de la leche, durante una temporada, se controla el porcentaje de materia grasa de la leche que proviene de ambas granjas, con los siguientes resultados:\n\n$$\n\\begin{array}{c|c}\nX & Y \\\\\n\\hline\n\\begin{array}[t]{rr}\n3.4 & 3.4 \\\\\n3.2 & 3.5 \\\\\n3.3 & 3.3 \\\\\n3.2 & 3.2 \\\\\n3.3 & 3.0 \\\\\n3.1 & 3.2 \\\\\n\\end{array}\n&\n\\begin{array}[t]{rr}\n2.8 & 2.9 \\\\\n3.0 & 3.2 \\\\\n3.2 & 3.1 \\\\\n2.9 & 2.9 \\\\\n3.1 & 3.2 \\\\\n2.9 & 3.1 \\\\\n3.3 & 3.2 \\\\\n3.2 & 3.3 \\\\\n\\end{array}\n\\end{array}\n$$\n\n\na.  Crear un conjunto de datos con los datos de la muestra.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- tibble(\n        grasa = c(3.4, 3.2, 3.3, 3.2, 3.3, 3.1, 3.4, 3.5, 3.3, 3.2, 3.0, 3.2, 2.8, 3.0, 3.2, 2.9, 3.1, 2.9, 3.3, 3.2, 2.9, 3.2, 3.1, 2.9, 3.2, 3.1, 3.2, 3.3),\n        granja = factor(c(rep(\"X\", 12), rep(\"Y\", 16)))\n    )\n    ```\n    :::\n\n    :::\n\na.  Calcular el contenido medio de materia grasa de la muestra de leche cada granja y los respectivos intervalos de confianza con un $95\\%$ de confianza. Dibujar los intervalos de confianza obtenidos.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(kableExtra)\n    #| message: false\n    tabla_ic <- df |> \n        group_by(granja) |>\n        summarise(\"Media\" = mean(grasa, na.rm = T), \n        \"IC 95% Inf\" = t.test(grasa)$conf.int[1], \n        \"IC 95% Sup\" = t.test(grasa)$conf.int[2]) \n        \n    tabla_ic |> \n        kable() |>\n        kable_styling()\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> granja </th>\n       <th style=\"text-align:right;\"> Media </th>\n       <th style=\"text-align:right;\"> IC 95% Inf </th>\n       <th style=\"text-align:right;\"> IC 95% Sup </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;\"> X </td>\n       <td style=\"text-align:right;\"> 3.258333 </td>\n       <td style=\"text-align:right;\"> 3.170719 </td>\n       <td style=\"text-align:right;\"> 3.345948 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Y </td>\n       <td style=\"text-align:right;\"> 3.081250 </td>\n       <td style=\"text-align:right;\"> 2.995950 </td>\n       <td style=\"text-align:right;\"> 3.166550 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n\n    ## `qwraps2`\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    library(qwraps2)\n    library(kableExtra)\n    df |> \n        group_by(granja)  |> \n        summarise(N = n(), \"Media (IC 95%)\" = frmtci(mean_ci(grasa, alpha = 0.05, qdist = qt, qdist.args = list(df = N-1)), digits = 4))  |> \n        kable()  |> \n        kable_styling()\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> granja </th>\n       <th style=\"text-align:right;\"> N </th>\n       <th style=\"text-align:left;\"> Media (IC 95%) </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;\"> X </td>\n       <td style=\"text-align:right;\"> 12 </td>\n       <td style=\"text-align:left;\"> 3.2583 (3.1707, 3.3459) </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Y </td>\n       <td style=\"text-align:right;\"> 16 </td>\n       <td style=\"text-align:left;\"> 3.0812 (2.9960, 3.1665) </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    :::\n\n    :::\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    tabla_ic  |> \n        ggplot(aes(x = granja, y = Media, color = granja)) +\n        geom_point(size = 3) +\n        geom_errorbar(aes(ymin = `IC 95% Inf`, ymax = `IC 95% Sup`), width = 0.2) +\n        labs(title = \"Intervalos de confianza del 95% para la media\", x = \"Granja\", y = \"Porcentaje de grasa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](07-intervalos-confianza_files/figure-html/unnamed-chunk-10-1.png){width=672}\n    :::\n    :::\n\n    :::\n\n\na.  A la vista de los intervalos de confianza obtenidos ¿Existen diferencias estadísticamente significativas entre los contenidos medios de grasa de la leche de las dos granjas? En tal caso, ¿qué granja produce leche con más grasa?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Como los intervalos no se solapan, es decir, no tienen valores en común, podemos concluir que los contenidos medios de grasa de las leches de las dos granjas son significativamente diferentes con un $95\\%$ de confianza. Además se aprecia que el intervalo de la granja $X$ tiene valores mayores que el de la granja $Y$, por lo que la leche de la granja $X$ tiene más contenido de grasa que la de la granja $Y$.\n    :::\n\na.  Repetir los cálculos anteriores tomando una confianza del $99\\%$. ¿Existen diferencias estadísticamente significativas entre el contenido medio de grasa de las leches de las dos granjas con este nivel de confianza?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    tabla_ic_99 <- df |> \n        group_by(granja) |>\n        summarise(\"Media\" = mean(grasa, na.rm = T), \n        \"IC 99% Inf\" = t.test(grasa, conf.level = 0.99)$conf.int[1], \n        \"IC 99% Sup\" = t.test(grasa, conf.level = 0.99)$conf.int[2]) \n        \n    tabla_ic_99 |> \n        kable() |>\n        kable_styling()\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n     <thead>\n      <tr>\n       <th style=\"text-align:left;\"> granja </th>\n       <th style=\"text-align:right;\"> Media </th>\n       <th style=\"text-align:right;\"> IC 99% Inf </th>\n       <th style=\"text-align:right;\"> IC 99% Sup </th>\n      </tr>\n     </thead>\n    <tbody>\n      <tr>\n       <td style=\"text-align:left;\"> X </td>\n       <td style=\"text-align:right;\"> 3.258333 </td>\n       <td style=\"text-align:right;\"> 3.134701 </td>\n       <td style=\"text-align:right;\"> 3.381966 </td>\n      </tr>\n      <tr>\n       <td style=\"text-align:left;\"> Y </td>\n       <td style=\"text-align:right;\"> 3.081250 </td>\n       <td style=\"text-align:right;\"> 2.963324 </td>\n       <td style=\"text-align:right;\"> 3.199176 </td>\n      </tr>\n    </tbody>\n    </table>\n    \n    `````\n    :::\n    \n    ```{.r .cell-code}\n    tabla_ic_99  |> \n        ggplot(aes(x = granja, y = Media, color = granja)) +\n        geom_point(size = 3) +\n        geom_errorbar(aes(ymin = `IC 99% Inf`, ymax = `IC 99% Sup`), width = 0.2) +\n        labs(title = \"Intervalos de confianza del 99% para la media\", x = \"Granja\", y = \"Porcentaje de grasa\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](07-intervalos-confianza_files/figure-html/unnamed-chunk-11-1.png){width=672}\n    :::\n    :::\n\n\n    Como se ve, ahora los dos intervalos se solapan y por tanto las medias del contenido de grasa de las leches de las dos granjas podrían ser iguales. Por tanto, no existen diferencias estadísticamente significativas entre el contenido medio de grasa de las leches de las dos granjas con un $99º%$ de confianza.\n    :::\n:::\n\n:::{#exr-uso-biblioteca}\nEn una encuesta realizada en una universidad, sobre si el alumnado utiliza habitualmente (al menos una vez a la semana) la biblioteca, se han obtenido los siguientes resultados:\n\n$$\n\\begin{array}{l}\n\\begin{array}{llllllllllllllllll}\n\\hline\n\\mbox{Alumno} & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 \\\\\n\\mbox{Respuesta} & \\mbox{no} & \\mbox{si}  & \\mbox{no} & \\mbox{no} & \\mbox{no} & \\mbox{si}  & \\mbox{no} & \\mbox{si}  & \\mbox{si}  & \\mbox{si}  & \\mbox{si}  & \\mbox{no} & \\mbox{si}  & \\mbox{no} & \\mbox{si}  & \\mbox{no} & \\mbox{no} \\\\\n\\hline\n\\end{array}\n\\\\\n\\begin{array}{llllllllllllllllll}\n\\hline\n\\mbox{Alumno} & 18 & 19 & 20 & 21 & 22 & 23 & 24 & 25 & 26 & 27 & 28 & 29 & 30 & 31 & 32 & 33 & 34 \\\\\n\\mbox{Respuesta} & \\mbox{no} & \\mbox{si}  & \\mbox{si}  & \\mbox{si}  & \\mbox{no} & \\mbox{no} & \\mbox{si}  & \\mbox{no} & \\mbox{no} & \\mbox{si}  & \\mbox{si}  & \\mbox{no} & \\mbox{no} & \\mbox{si}  & \\mbox{no} & \\mbox{si}  & \\mbox{no} \\\\\n\\hline\n\\end{array}\n\\end{array}\n$$\n\n\n\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}