{
  "hash": "b918573fb632edd0298948c7152ecc7a",
  "result": {
    "markdown": "---\ntitle: Contrastes de hipótesis paramétricos de una y dos poblaciones\nknitr: \n    opts_chunk: \n      R.options:\n        warning: false\nlang: es\n---\n\n\n## Ejercicios Resueltos\n\nPara la realización de esta práctica se requieren los siguientes paquetes:\n\n```r\nlibrary(tidyverse)\n# Incluye los siguientes paquetes:\n# - dplyr: para el preprocesamiento y manipulación de datos.\n# - purrr: para aplicar funciones a vectores.\nlibrary(broom) # para convertir las listas con los resúmenes de los modelos de regresión a formato organizado.\nlibrary(tidymodels) # para realizar contrastes de hipótesis en formato tidy.\nlibrary(pwr) # para el cálculo de tamaños muestrales.\nlibrary(knitr) # para el formateo de tablas.\n```\n\n:::{#exr-contraste-hipotesis-proporcion-hombres}\nPara averiguar si en una determinada población existen menos hombres que mujeres se plantea el siguiente contraste de hipótesis sobre la proporción de hombres que hay en la población: \n\n\\begin{align*}\nH_0 &: p=0.5\\\\\nH_1 &: p<0.5 \n\\end{align*}\n\nPara ello se ha tomado una muestra aleatoria con reemplazamiento de $10$ personas. \n\na.  Suponiendo cierta la hipótesis nula, ¿qué distribución sigue la variable que mide el número de hombres en la muestra de tamaño 10?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Suponiendo cierta la hipótesis nula, es decir, que la proporción de hombres en la población es $0.5$, el número de hombres en una muestra aleatoria con reemplazamiento de 10 personas sigue una distribución Binomial $B(10, 0.5)$.\n    :::\n\na.  Suponiendo cierta la hipótesis nula, ¿cuál es la probabilidad de que en la muestra se obtengan 0 hombres?\n¿Se aceptaría la hipótesis nula en tal caso? \n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Tenemos que calcular la probabilidad de $0$ hombres con la distribución $B(10, 0.5)$.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-1_598f7f6c0383e00aec13b27c98b2cf71'}\n    \n    ```{.r .cell-code}\n    pbinom(0, 10, 0.5)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 0.0009765625\n    ```\n    :::\n    :::\n\n\n    Como se ve, la probabilidad de obtener 0 hombres en una muestra aleatoria con reemplazamiento de 10 personas tomadas de una población con el mismo número de hombres y mujeres es muy baja, por lo que, en este caso rechazaríamos la hipótesis nula sin dudarlo.\n    :::\n\n\na.  Suponiendo cierta la hipótesis nula, si se decide rechazarla cuando en la muestra haya 2 o menos hombres, ¿cuál es el riesgo de equivocarse?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Tenemos que calcular la probabilidad de haya $2$ o menos hombres con la distribución $B(10, 0.5)$.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-2_ba8dec0fc85efbeb8196c00058cf828a'}\n    \n    ```{.r .cell-code}\n    pbinom(2, 10, 0.5)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 0.0546875\n    ```\n    :::\n    :::\n\n\n    La probabilidad de cometer un error de tipo I (rechazar la hipótesis nula cuando es cierta) es $0.0547$.\n    :::\n\na.  Si el máximo riesgo de error de tipo I $\\alpha$ que se tolera es $0.05$, ¿qué número de hombres en la muestra formarían la región de rechazo de la hipótesis nula?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Si el máximo riesgo de error de tipo I se establece en $\\alpha=0.05$, solo podría rechazarse la hipótesis nula si en la muestra aleatoria con reemplazamiento de $10$ personas se obtuviese $0$ o $1$ hombres. Si se obtuviesen $2$ hombres ya no se podría rechazar la hipótesis nula porque la probabilidad de equivocarnos es mayor de $0.05$ como se ha visto en el apartado anterior.\n    :::\n\na.  Suponiendo que la proporción real de hombres en la población fuese de $0.4$, ¿cuál es la potencia del contraste para la región de rechazo del apartado anterior?\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    La potencia de un contraste es $1-\\beta$, donde $\\beta$ es la probabilidad de cometer un error de tipo II (aceptar la hipótesis nula cuando es falsa).\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Tenemos que calcular la probabilidad de haya $1$ o menos hombres con la distribución $B(10, 0.4)$.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-3_76d38bc788bf8583990284e0d7039341'}\n    \n    ```{.r .cell-code}\n    pbinom(1, 10, 0.4)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 0.0463574\n    ```\n    :::\n    :::\n\n\n    La potencia del contraste suponiendo que la proporción real de hombres en la población es $0.4$, es $0.0464$ que es muy baja.\n    :::\n\na.  Si en lugar de una muestra de tamaño 10 se tomase una muestra de tamaño 100, y haciendo uso de la aproximación de una distribución binomial mediante una normal, ¿qué número de hombres en la muestra formarían la región de rechazo para un riesgo $\\alpha=0.05$? \n¿Qué potencia tendría ahora el contraste si la proporción real de hombres fuese de $0.4$? ¿Es mejor o peor contraste que el anterior?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n    Si tomamos una muestra de $100$ personas, entonces el número de hombres en la muestra si en la población hay el mismo número de hombres que de mujeres sigue una distribución binomial $B(100,0.5)$, que puede aproximarse mediante una distribución normal $N(50,5)$, así que tenemos que calcular el percentil $5$ de esta distribución.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-4_eb8c8e5d064a0fe0d9db763292e4e75f'}\n    \n    ```{.r .cell-code}\n    qnorm(0.05, 50, 5)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 41.77573\n    ```\n    :::\n    :::\n\n\n    Por tanto, para un riesgo $\\alpha=0.05$, rechazaremos la hipótesis nula si en la muestra se obtienen $41$ o menos hombres.\n\n    Si la proporción real de hombres fuese de $0.4$, la potencia del contraste es la probabilidad de obtener $41$ o menos hombres con una distribución binomial $B(100, 0.4)$.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-5_bb65d5a6215a6940304edf23c3be2376'}\n    \n    ```{.r .cell-code}\n    pbinom(41, 100, 0.4)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 0.6225327\n    ```\n    :::\n    :::\n\n\n    Ahora la potencia del contraste ha aumentado hasta $0.6225$ que es mucho mayor que la del contraste anterior.\n    :::\n:::\n\n\n:::{#exr-contraste-hipotesis-media-principio-activo}\nSe sabe que para que un fármaco sea efectivo, la concentración de su principio activo debe ser de al menos $16$ mg/mm$^3$. Una farmacia va a comprar un lote de este medicamento, pero antes quiere asegurarse de que los medicamentos del lote son efectivos y para ello analiza la concentración de principio activo en una muestra aleatoria de $10$ envases tomados del lote, obteniendo los siguientes resultados en mg/mm$^{3}$:\n\n$$\n17.6 \\quad 19.2 \\quad 21.3 \\quad 15.1 \\quad 17.6 \\quad 18.9 \\quad 16.2 \\quad 18.3 \\quad 19.0 \\quad 16.4\n$$\n\na.  Crear un conjunto de datos con los datos de la muestra.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-6_72018ace71f53e3a3cea1ac5f2d6ac0d'}\n    \n    ```{.r .cell-code}\n    df <- data.frame(concentracion = c(17.6, 19.2, 21.3, 15.1, 17.6, 18.9, 16.2, 18.3, 19.0, 16.4 ))\n    ```\n    :::\n\n    :::\n\na.  Realizar un contraste de hipótesis para ver si la concentración media de principio activo es diferente de $18$ mg/mm$^3$.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para realizar un contraste de hipótesis para la media de una población podemos utilizar la función [`t.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test) del paquete `stats`.\n\n    Si queremos mostrar la salida del test en formato de tabla podemos utilizar la función `tidy` del paquete [`broom`](https://broom.tidymodels.org/index.html).\n\n    Otra opción es utilizar la función [`t_test`](https://infer.tidymodels.org/reference/t_test.html) de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Tenemos que realizar el contraste bilateral\n\n    \\begin{align*}\n    H_0 &: \\mu=18\\\\\n    H_1 &: \\mu\\neq 18 \n    \\end{align*}\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-7_d4f34b8e8fb2e94cdcf12dd66955ebc8'}\n    \n    ```{.r .cell-code}\n    t.test(df$concentracion, mu = 18)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    \tOne Sample t-test\n    \n    data:  df$concentracion\n    t = -0.07078, df = 9, p-value = 0.9451\n    alternative hypothesis: true mean is not equal to 18\n    95 percent confidence interval:\n     16.68158 19.23842\n    sample estimates:\n    mean of x \n        17.96 \n    ```\n    :::\n    :::\n\n\n    Para mostrar la salida en formato tabla.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-8_6019c38d053b6b38737f60f8977663b0'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    tidy(t.test(df$concentracion, mu = 18)) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate|  statistic|   p.value| parameter| conf.low| conf.high|method            |alternative |\n    |--------:|----------:|---------:|---------:|--------:|---------:|:-----------------|:-----------|\n    |    17.96| -0.0707795| 0.9451211|         9| 16.68158|  19.23842|One Sample t-test |two.sided   |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-9_62fbc42d1c06a56831d8d52f093bfe8e'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n        t_test(response = concentracion, mu = 18) |> \n        kable() \n    ```\n    \n    ::: {.cell-output-display}\n    |  statistic| t_df|   p_value|alternative | estimate| lower_ci| upper_ci|\n    |----------:|----:|---------:|:-----------|--------:|--------:|--------:|\n    | -0.0707795|    9| 0.9451211|two.sided   |    17.96| 16.68158| 19.23842|\n    :::\n    :::\n\n    :::\n    \n    Como el p-valor del contraste es $0.9451$ que es mucho mayor que el riesgo $\\alpha=0.05$, no rechazamos la hipótesis nula.\n\n    Obsérvese que el valor de la media muestral es $17.96$ que está muy cerca del valor que establece la hipótesis nula, por lo que sería una locura rechazar la hipótesis nula con esta muestra.\n    :::\n\n\na.  Realizar un contraste de hipótesis para ver si la concentración media de principio activo es diferente de $19.5$ mg/mm$^3$.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Tenemos que realizar el contraste bilateral\n\n    \\begin{align*}\n    H_0 &: \\mu=19.5\\\\\n    H_1 &: \\mu\\neq 19.5\n    \\end{align*}\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-10_2b884c46970f30952679f7045fd20ef7'}\n    \n    ```{.r .cell-code}\n    tidy(t.test(df$concentracion, mu = 19.5)) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| statistic|   p.value| parameter| conf.low| conf.high|method            |alternative |\n    |--------:|---------:|---------:|---------:|--------:|---------:|:-----------------|:-----------|\n    |    17.96| -2.725012| 0.0234149|         9| 16.68158|  19.23842|One Sample t-test |two.sided   |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-11_d1d95fbe2854bbbeb218150fbf2569a4'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n        t_test(response = concentracion, mu = 19.5) |> \n        kable() \n    ```\n    \n    ::: {.cell-output-display}\n    | statistic| t_df|   p_value|alternative | estimate| lower_ci| upper_ci|\n    |---------:|----:|---------:|:-----------|--------:|--------:|--------:|\n    | -2.725012|    9| 0.0234149|two.sided   |    17.96| 16.68158| 19.23842|\n    :::\n    :::\n\n    :::\n    \n    Como el p-valor del contraste es $0.0234$ que es menor que el riesgo $\\alpha=0.05$, rechazamos la hipótesis nula y concluimos que la concentración media es significativamente diferente de $19$.\n\n    Obsérvese que ahora el valor de la media muestral es $17.96$ está mucho más lejos del valor que establece la hipótesis nula, por lo que tiene más lógica rechazar la hipótesis nula.\n    :::\n\na.  Si el fabricante del lote asegura haber aumentado la concentración de principio activo con respecto a anteriores lotes, en los que la media era de $17$ mg/mm$^3$, ¿podemos aceptar la afirmación del fabricante?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Ahora tenemos que realizar el contraste unilateral\n\n    \\begin{align*}\n    H_0 &: \\mu=17\\\\\n    H_1 &: \\mu> 17\n    \\end{align*}\n\n    :::{.panel-tabset}\n    ## `stats`.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-12_5716b2ac4c73fb6dc86288d7af2c3b55'}\n    \n    ```{.r .cell-code}\n    tidy(t.test(df$concentracion, mu = 17, alternative = \"greater\")) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| statistic|   p.value| parameter| conf.low| conf.high|method            |alternative |\n    |--------:|---------:|---------:|---------:|--------:|---------:|:-----------------|:-----------|\n    |    17.96|  1.698709| 0.0617985|         9| 16.92404|       Inf|One Sample t-test |greater     |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-13_f7e6252decd0c74b11e34c45da45201c'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n        t_test(response = concentracion, mu = 19.5, alternative = \"greater\") |> \n        kable() \n    ```\n    \n    ::: {.cell-output-display}\n    | statistic| t_df|   p_value|alternative | estimate| lower_ci| upper_ci|\n    |---------:|----:|---------:|:-----------|--------:|--------:|--------:|\n    | -2.725012|    9| 0.9882925|greater     |    17.96| 16.92404|      Inf|\n    :::\n    :::\n\n    :::\n    \n    Como el p-valor del contraste es $0.0618$ que es mayor que el riesgo $\\alpha=0.05$, no podemos rechazar la hipótesis nula y concluimos que con esta muestra no hay pruebas significativas de que la afirmación del fabricante sea cierta.\n    :::\n\na.  ¿Cuál sería el tamaño muestral requerido para poder detectar una diferencia de $0.5$ mg/mm$^{3}$ más con un nivel de significación $\\alpha=0.05$ y una potencia $1-\\beta=0.8$?\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Ahora tenemos que realizar el contraste unilateral\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-14_524db6ce57cc71c8b78745882bd5d1ba'}\n    \n    ```{.r .cell-code}\n    library(pwr)\n    efecto <- 0.5 / sd(df$concentracion)\n    power.t.test(d = efecto, sig.level = 0.05, power = 0.8, type = \"one.sample\", alternative = \"two.sided\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n         One-sample t test power calculation \n    \n                  n = 102.2077\n              delta = 0.2797806\n                 sd = 1\n          sig.level = 0.05\n              power = 0.8\n        alternative = two.sided\n    ```\n    :::\n    :::\n\n    :::\n\n:::\n\n:::{#exr-contraste-hipotesis-proporcion-uso-biblioteca}\nEl conjunto de datos [`biblioteca.csv`](https://aprendeconalf.es/estadistica-practicas-r/datos/biblioteca.csv) contiene los resultados de una encuesta realizada en una universidad, sobre si el alumnado utiliza habitualmente (al menos una vez a la semana) la biblioteca.\n\na.  Crear conjunto de datos con los datos de la muestra a partir del fichero [`biblioteca.csv`](https://aprendeconalf.es/estadistica-practicas-r/datos/biblioteca.csv).\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-15_f3d24869ef716543862d1a109b1a8aa0'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- read_csv(\"https://aprendeconalf.es/estadistica-practicas-r/datos/biblioteca.csv\")\n    ```\n    :::\n\n    :::\n\na.  Contrastar si el porcentaje de alumnos que utiliza habitualmente la biblioteca es superior al $40\\%$. \n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para realizar un contraste de hipótesis para la proporción de una población podemos utilizar la función [`prop.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/prop.test) del paquete `stats`.\n\n    Si queremos mostrar la salida del test en formato de tabla podemos utilizar la función `tidy` del paquete [`broom`](https://broom.tidymodels.org/index.html).\n\n    Otra opción es utilizar la función [`prop_test`](https://infer.tidymodels.org/reference/prop_test.html) de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Tenemos que realizar el contraste unilateral\n\n    \\begin{align*}\n    H_0 &: p = 0.4\\\\\n    H_1 &: p > 0.4 \n    \\end{align*}\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-16_b5601cc008e3178001639f9b210a62f2'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    frec <- table(df$respuesta)\n    tidy(prop.test(frec[\"si\"], nrow(df), p = 0.4, alternative = \"greater\")) |> \n    kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |  estimate| statistic|   p.value| parameter|  conf.low| conf.high|method                                               |alternative |\n    |---------:|---------:|---------:|---------:|---------:|---------:|:----------------------------------------------------|:-----------|\n    | 0.4705882|  0.442402| 0.2529827|         1| 0.3238772|         1|1-sample proportions test with continuity correction |greater     |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-17_5883b1ff5edc45eeef5464af0ea53161'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    library(knitr)\n    df  |> \n        prop_test(response = respuesta, p = 0.4, alternative = \"greater\", success = \"si\") |>\n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | statistic| chisq_df|   p_value|alternative |\n    |---------:|--------:|---------:|:-----------|\n    |  0.442402|        1| 0.2529827|greater     |\n    :::\n    :::\n\n    :::\n    \n    Como el p-valor del contraste es $0.253$, que es  mayor que el riesgo $\\alpha=0.05$, no rechazamos la hipótesis nula.\n    :::\n:::\n\n:::{#exr-contraste-hipotesis-media-edad-andar}\nUn estudio trata de averiguar si existen diferencias significativas en la edad media a la que los niños de África y Europa comienzan a andar por sí solos. Los investigadores obtuvieron los siguientes datos para la edad al comenzar a andar (expresada en meses):\n\n\\begin{align*}\n\\textrm{África}:& \\ 9.5-10.5-9.0-9.8-10.0-13.0-10.0-13.5-10.0-9.8\\\\\n\\textrm{Europa}:& \\ 12.5-9.5-13.5-13.8-12.0-13.8-12.5-9.5-12.0-13.5-12.0-12.0\n\\end{align*}\n\na.  Crear un conjunto de datos con los datos de la muestra.\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-18_86eb732b0e616992aacb0248d84b2138'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- tibble(\n        edad = c(9.5, 10.5, 9.0, 9.8, 10.0, 13.0, 10.0, 13.5, 10.0, 9.8, 12.5, 9.5, 13.5, 13.8, 12.0, 13.8, 12.5, 9.5, 12.0, 13.5, 12.0, 12.0),\n        continente = factor(c(rep(\"África\", 10), rep(\"Europa\", 12)))\n    )\n    ```\n    :::\n\n    :::\n\na.  Realizar un contraste de hipótesis con un nivel de significación de $0.05$ para ver si existen diferencias estadísticamente significativas entre las edades medias a las que comienzan a andar los niños de África y los de Europa.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para realizar un contraste de hipótesis para la diferencia de medias de dos población independientes utilizar la función [`t.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test) del paquete `stats`. Este test da resultados diferentes dependiendo de si las dos poblaciones que se comparan tienen varianzas diferentes o no, por lo que previamente debemos realizar un contraste de comparación de varianzas mediante la función [`var.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/var.test) del paquete `stats`. Si se acepta la hipótesis de igualdad de varianzas mediante este test, en la función `t.test` hay que añadir el parámetro `var.equal = TRUE`.\n\n    Si queremos mostrar la salida del test en formato de tabla podemos utilizar la función `tidy` del paquete [`broom`](https://broom.tidymodels.org/index.html).\n\n    Otra opción es utilizar la función [`t_test`](https://infer.tidymodels.org/reference/t_test.html) de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n    Tenemos que realizar el contraste bilateral\n\n    \\begin{align*}\n    H_0 &: \\mu_A = \\mu_E \\\\\n    H_1 &: \\mu_A \\neq \\mu_E \n    \\end{align*}\n\n    Realizamos primero el test F para la comparación de las varianzas de las dos poblaciones.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-19_0738afe10ca7e1ae3b4556fcfe7db206'}\n    \n    ```{.r .cell-code}\n    var.test(edad ~ continente, data = df)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    \tF test to compare two variances\n    \n    data:  edad by continente\n    F = 1.0558, num df = 9, denom df = 11, p-value = 0.9164\n    alternative hypothesis: true ratio of variances is not equal to 1\n    95 percent confidence interval:\n     0.2942791 4.1305381\n    sample estimates:\n    ratio of variances \n              1.055843 \n    ```\n    :::\n    :::\n\n\n    Como el p-valor del contraste es $0.9164$, que es mayor que el riesgo $\\alpha=0.05$, no se rechaza la hipótesis nula y concluimos que no hay una diferencia estadísticamente significativas entre las varianzas de las dos poblaciones. \n\n    A continuación realizamos el contraste de comparación de medias.\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-20_b409ef9a91d2d01f09afedaabfc5accc'}\n    \n    ```{.r .cell-code}\n    t.test(edad ~ continente, data = df, var.equal = TRUE)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    \tTwo Sample t-test\n    \n    data:  edad by continente\n    t = -2.6982, df = 20, p-value = 0.01383\n    alternative hypothesis: true difference in means between group África and group Europa is not equal to 0\n    95 percent confidence interval:\n     -3.0260864 -0.3872469\n    sample estimates:\n    mean in group África mean in group Europa \n                10.51000             12.21667 \n    ```\n    :::\n    :::\n\n\n    Para mostrar la salida en formato tabla.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-21_4377f5203786fba8c32db1ff54210444'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    tidy(t.test(edad ~ continente, data = df, var.equal = TRUE)) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |  estimate| estimate1| estimate2| statistic|   p.value| parameter|  conf.low|  conf.high|method            |alternative |\n    |---------:|---------:|---------:|---------:|---------:|---------:|---------:|----------:|:-----------------|:-----------|\n    | -1.706667|     10.51|  12.21667| -2.698189| 0.0138327|        20| -3.026086| -0.3872469|Two Sample t-test |two.sided   |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-22_fa8405d5a0fbc2daea2015eb1c6ac47c'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n        t_test(edad ~ continente, var.equal = TRUE) |> \n        kable() \n    ```\n    \n    ::: {.cell-output .cell-output-stderr}\n    ```\n    Warning: The statistic is based on a difference or ratio; by default, for\n    difference-based statistics, the explanatory variable is subtracted in the\n    order \"África\" - \"Europa\", or divided in the order \"África\" / \"Europa\" for\n    ratio-based statistics. To specify this order yourself, supply `order =\n    c(\"África\", \"Europa\")`.\n    ```\n    :::\n    \n    ::: {.cell-output-display}\n    | statistic| t_df|   p_value|alternative |  estimate|  lower_ci|   upper_ci|\n    |---------:|----:|---------:|:-----------|---------:|---------:|----------:|\n    | -2.698189|   20| 0.0138327|two.sided   | -1.706667| -3.026086| -0.3872469|\n    :::\n    :::\n\n    :::\n    \n    Como el p-valor del contraste es $0.0138$ que es menor que el riesgo $\\alpha=0.05$, podemos rechazar la hipótesis nula y se concluye que existe una diferencia estadísticamente significativa entre las edades medias a las que comienzan a andar los niños de África y Europa.\n\n    Aunque se ha planteado un contraste bilateral, observando el intervalo de confianza para la diferencia entre la edad media de los niños de África y los de Europa, que es completamente negativo, se puede concluir con un $95\\%$ de confianza que los niños de África comienzan a andar entre $0.3872$ meses y $3.261$ meses antes que los niños de Europa en promedio.\n    :::\n:::\n\n:::{#exr-contraste-hipotesis-media-hipertension}\nEl conjunto de datos `hipertension.csv` contiene datos de la presión arterial de una muestra de individuos hipertensos, antes y después de aplicarles tres tratamientos (Placebo, IECA y Antagonista del Calcio + Diurético).\n\na.  Crear un conjunto de datos con los datos de la muestra.\n    \n    :::{.callout-tip collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-23_932876a4b7e64c8068707fc5d889ffb7'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- read_csv(\"https://aprendeconalf.es/estadistica-practicas-r/datos/hipertension.csv\")\n    glimpse(df)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Rows: 100\n    Columns: 15\n    $ ...1      <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…\n    $ NOMBRE    <chr> \"SGL\", \"JCZ\", \"APZ\", \"NDG\", \"CLO\", \"LFZ\", \"OAR\", \"SGH\", \"ZLZ…\n    $ EDAD      <dbl> 57, 40, 30, 44, 38, 48, 41, 31, 39, 31, 34, 27, 32, 59, 29, …\n    $ SEXO      <chr> \"Mujer\", \"Mujer\", \"Hombre\", \"Hombre\", \"Mujer\", \"Hombre\", \"Mu…\n    $ ESTATURA  <dbl> 165, 154, 156, 181, 184, 179, 159, 153, 172, 154, 170, 154, …\n    $ PESO      <dbl> 93, 80, 74, 88, 86, 73, 70, 57, 55, 50, 64, 57, 54, 77, 91, …\n    $ ESTRES    <dbl> 42, 30, 21, 33, 36, 22, 31, 12, 21, 24, 32, 20, 30, 26, 18, …\n    $ PAD_INI   <dbl> 80, 92, 87, 84, 88, 70, 91, 84, 69, 84, 88, 85, 83, 88, 75, …\n    $ PAD_FIN   <dbl> 84, 89, 83, 79, 80, 82, 80, 73, 67, 77, 75, 83, 80, 72, 72, …\n    $ PAS_INI   <dbl> 180, 167, 148, 167, 170, 148, 173, 140, 155, 153, 166, 153, …\n    $ PAS_FIN   <dbl> 155, 140, 130, 141, 142, 128, 132, 123, 115, 135, 128, 133, …\n    $ TAB_INI   <chr> \"si\", \"no\", \"no\", \"si\", \"si\", \"si\", \"no\", \"no\", \"no\", \"no\", …\n    $ TAB_FIN   <chr> \"si\", \"no\", \"no\", \"no\", \"si\", \"si\", \"no\", \"no\", \"no\", \"no\", …\n    $ CAR_ISQUE <chr> \"si\", \"no\", \"no\", \"si\", \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", …\n    $ FARMACO   <chr> \"Antagonista Calcio + Diurético\", \"Antagonista Calcio + Diur…\n    ```\n    :::\n    :::\n\n    :::\n\na.  Realizar un contraste de hipótesis para ver si hay la media de la presión sistólica ha disminuido significativamente.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Ayuda\n    Para realizar un contraste de hipótesis para la diferencia de medias de dos población pareadas utilizar la función [`t.test`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test) del paquete `stats` añadiendo el parámetro `paired = TRUE`.\n\n    Si queremos mostrar la salida del test en formato de tabla podemos utilizar la función `tidy` del paquete [`broom`](https://broom.tidymodels.org/index.html).\n\n    Otra opción es utilizar la función [`t_test`](https://infer.tidymodels.org/reference/t_test.html) de la colección de paquetes `tidymodels`, que ofrece ya la salida en formato `tidy`.\n    :::\n\n    :::{.callout-tip collapse=\"true\"}   \n    ## Solución\n\n    Tenemos que realizar el contraste de hipótesis unilateral\n\n    \\begin{align*}\n    H_0 &: \\mu_I = \\mu_F \\\\\n    H_1 &: \\mu_I \\neq \\mu_F \n    \\end{align*}\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-24_a78588e319b7445523777ec23e6c71fd'}\n    \n    ```{.r .cell-code}\n    t.test(df$PAS_INI, df$PAS_FIN, paired = TRUE, alternative = \"greater\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    \tPaired t-test\n    \n    data:  df$PAS_INI and df$PAS_FIN\n    t = 31.743, df = 99, p-value < 2.2e-16\n    alternative hypothesis: true mean difference is greater than 0\n    95 percent confidence interval:\n     26.99975      Inf\n    sample estimates:\n    mean difference \n              28.49 \n    ```\n    :::\n    :::\n\n\n    Para mostrar la salida en formato tabla.\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-25_41b37b3a64703222e1cc5f29d7e37e8b'}\n    \n    ```{.r .cell-code}\n    library(broom)\n    library(knitr)\n    tidy(t.test(df$PAS_INI, df$PAS_FIN, paired = TRUE, alternative = \"greater\")) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    | estimate| statistic| p.value| parameter| conf.low| conf.high|method        |alternative |\n    |--------:|---------:|-------:|---------:|--------:|---------:|:-------------|:-----------|\n    |    28.49|  31.74278|       0|        99| 26.99975|       Inf|Paired t-test |greater     |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-26_4d3105a4502c190d43bbc114a83c3509'}\n    \n    ```{.r .cell-code}\n    library(tidymodels)\n    df |> \n    mutate(PAS_DIF = PAS_INI - PAS_FIN) |> \n        t_test(response = PAS_DIF, alternative = \"greater\") |> \n        kable() \n    ```\n    \n    ::: {.cell-output-display}\n    | statistic| t_df| p_value|alternative | estimate| lower_ci| upper_ci|\n    |---------:|----:|-------:|:-----------|--------:|--------:|--------:|\n    |  31.74278|   99|       0|greater     |    28.49| 26.99975|      Inf|\n    :::\n    :::\n\n    :::\n    \n    Como el p-valor del contraste es prácticamente $0$, que es mucho menor que el riesgo $\\alpha=0.05$, podemos rechazar con contundencia la hipótesis nula y se concluye que existe una diferencia estadísticamente muy significativa entre las medias de la presión arterial sistólica antes y después del tratamiento.\n    :::\n\na.  Realizar el mismo contraste de antes, pero para cada tratamiento por separado.\n\n    :::{.callout-tip collapse=\"true\"}   \n    ## Solución\n\n    :::{.panel-tabset}\n    ## `stats`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-27_7979d2b7a0bb920efc816a588e111afd'}\n    \n    ```{.r .cell-code}\n    df |> \n        nest(data = -FARMACO) |> \n        mutate(test = map(data, ~ tidy(t.test(.x$PAS_INI, .x$PAS_FIN, paired = TRUE, alternative = \"greater\")))) |> \n        unnest(test) |>\n        select(-data) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |FARMACO                        | estimate| statistic| p.value| parameter| conf.low| conf.high|method        |alternative |\n    |:------------------------------|--------:|---------:|-------:|---------:|--------:|---------:|:-------------|:-----------|\n    |Antagonista Calcio + Diurético | 26.63636|  99.52715|       0|        32| 26.18303|       Inf|Paired t-test |greater     |\n    |Placebo                        | 18.63636|  58.37322|       0|        32| 18.09557|       Inf|Paired t-test |greater     |\n    |IECA                           | 39.85294| 145.42329|       0|        33| 39.38915|       Inf|Paired t-test |greater     |\n    :::\n    :::\n\n\n    ## `tidymodels`\n\n\n    ::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-28_620f778120403f1aa330033b0252e466'}\n    \n    ```{.r .cell-code}\n    df |> \n    mutate(PAS_DIF = PAS_INI - PAS_FIN) |> \n    nest(data = -FARMACO) |> \n        mutate(test = map(data, ~ t_test(x = .x, response = PAS_DIF, paired = TRUE, alternative = \"greater\"))) |> \n        unnest(test) |>\n        select(-data) |> \n        kable()\n    ```\n    \n    ::: {.cell-output-display}\n    |FARMACO                        | statistic| t_df| p_value|alternative | estimate| lower_ci| upper_ci|\n    |:------------------------------|---------:|----:|-------:|:-----------|--------:|--------:|--------:|\n    |Antagonista Calcio + Diurético |  99.52715|   32|       0|greater     | 26.63636| 26.18303|      Inf|\n    |Placebo                        |  58.37322|   32|       0|greater     | 18.63636| 18.09557|      Inf|\n    |IECA                           | 145.42329|   33|       0|greater     | 39.85294| 39.38915|      Inf|\n    :::\n    :::\n\n    :::\n\n    Como se puede observar, todos los p-valores son menores que el nivel de significación $\\alpha=0.05$, por lo que se puede concluir que existe una diferencia estadísticamente muy significativa entre las medias de la presión arterial sistólica antes y después de cada tratamiento. Si observamos los intervalos de confianza, se observa que la mayor diferencia entre se da para el tratamiento IECA, después el Antagonista del Calcio y finalmente el Placebo.\n    :::\n:::\n\n:::{#exr-contraste-hipotesis-proporciones-aprobados}\nUn profesor universitario ha tenido dos grupos de clase a lo largo del año: uno con horario de mañana y otro de tarde. En el de mañana, sobre un total de $80$ alumnos, han aprobado $55$; y en el de tarde, sobre un total de $90$ alumnos, han aprobado $32$. ¿Se puede afirmar que hay diferencias significativas entre los porcentajes de aprobados en ambos grupos?\n\n:::{.callout-tip collapse=\"true\"}\n## Solución\n\nTenemos que realizar el contraste bilateral\n\n\\begin{align*}\nH_0 &: p_M = p_T \\\\\nH_1 &: p_M \\neq p_T \n\\end{align*}\n\n\n::: {.cell hash='09-contrastes-hipotesis-parametricos-una-y-dos-poblaciones_cache/html/unnamed-chunk-29_f7f85a883ea544a180e844a96fc36998'}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(knitr) \n# Aplicamos el test de comparación de proporciones.\ntidy(prop.test(c(55, 32), c(80, 90))) |> \n    # Multiplicamos por 100 todas las columnas para obtener porcentajes.\n    mutate(across(c(estimate1, estimate2, conf.low, conf.high), ~ .x * 100)) |> \n    # Mostramos por pantalla en formato tabla.\n    kable()\n```\n\n::: {.cell-output-display}\n| estimate1| estimate2| statistic|  p.value| parameter| conf.low| conf.high|method                                                               |alternative |\n|---------:|---------:|---------:|--------:|---------:|--------:|---------:|:--------------------------------------------------------------------|:-----------|\n|     68.75|  35.55556|  17.37244| 3.07e-05|         1| 17.83764|  48.55125|2-sample test for equality of proportions with continuity correction |two.sided   |\n:::\n:::\n\n\nComo el p-valor del contraste es prácticamente $0$, que es mucho menor que el riesgo $\\alpha=0.05$, podemos rechazar con contundencia la hipótesis nula y se concluye que existe una diferencia estadísticamente muy significativa entre los porcentajes de aprobados en la mañana y la tarde. Si observamos el intervalo de confianza para diferencia entre la proporción de aprobados en la mañana y la tarde, que es completamente positivo, se concluye con un $95\\%$ de confianza que el porcentaje de aprobados en la mañana es significativamente mayor que en la tarde.\n:::\n:::\n\n## Ejercicios propuestos\n\n:::{#exr-contraste-hipotesis-pulso}\nEl fichero [`pulso.csv`](https://aprendeconalf.es/estadistica-practicas-r/datos/pulso.csv) contiene información sobre el pulso de un grupo de pacientes que han realizado\ndistintos ejercicios: pulso en reposo (pulse1), pulso después de hacer ejercicio (pulse2), tipo de ejercicio (ran, 1=correr, 2=andar), sexo (sex, 1=hombre, 2=mujer) y peso (weight).\n\na.  Contrastar si el pulso en reposo está por debajo de $75$ pulsaciones.\n\na.  ¿Qué tamaño muestral sería necesario para detectar una diferencia de 2 pulsaciones más en la media de las pulsaciones en reposo, con un nivel de significación $0.05$ y una potencia de $0.9$?\n\na.  Contrastar si el pulso después de correr está por encima de $85$ pulsaciones.\n\na.  Contrastar si el porcentaje de personas con taquicardia leve (número de pulsaciones en reposo por encima de $90$) supera el $5\\%$.\n\na.  ¿Se puede afirmar que el ejercicio aumenta las pulsaciones con una significación de $0.05$? ¿y con una significación $0.01$?\n\na.  ¿Existe una diferencia significativa entre las medias de las pulsaciones después de andar y después de correr?\n\na.  ¿Existe una diferencia significativa entre la media de las pulsaciones en reposo de hombres y mujeres? ¿Y entre las medias de las pulsaciones después de correr?\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}